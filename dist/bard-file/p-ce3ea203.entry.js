import{g as t,r as e,c as i,h as s,H as r}from"./p-Cu049DBy.js";class n{static instance(t){return t.bardFileFormController||=new n(t)}progressContainerTarget;dialog;element;progressTargetMap;controllers;submitted;processing;errors;constructor(t){this.element=t;this.progressTargetMap={};this.controllers=[];this.submitted=false;this.processing=false;this.errors=false;this.element.insertAdjacentHTML("beforeend",`<dialog id="form-controller-dialog">\n        <div class="direct-upload-wrapper">\n          <div class="direct-upload-content">\n            <h3>Uploading your media</h3>\n            <div id="progress-container"></div>\n          </div>\n        </div>\n      </dialog>`);this.dialog=this.element.querySelector("#form-controller-dialog");this.progressContainerTarget=this.dialog.querySelector("#progress-container");if(this.element.dataset.remote!=="true"&&(this.element.dataset.turbo=="false"||!window.Turbo?.session?.enabled)){this.element.addEventListener("submit",(t=>this.submit(t)))}window.addEventListener("beforeunload",(t=>this.beforeUnload(t)));this.element.addEventListener("direct-upload:initialize",(t=>this.init(t)));this.element.addEventListener("direct-upload:start",(t=>this.start(t)));this.element.addEventListener("direct-upload:progress",(t=>this.progress(t)));this.element.addEventListener("direct-upload:error",(t=>this.error(t)));this.element.addEventListener("direct-upload:end",(t=>this.end(t)));this.element.addEventListener("uploaded-file:remove",(t=>this.removeUploadedFile(t)))}beforeUnload(t){if(this.processing){t.preventDefault();return t.returnValue=""}}submit(t){t.preventDefault();this.submitted=true;this.startNextController();if(this.processing){this.dialog.showModal()}}startNextController(){if(this.processing)return;const t=this.controllers.shift();if(t){this.processing=true;t.start((t=>{if(t){Array.from(this.element.querySelectorAll("input[type=file]")).forEach((t=>t.disabled=false))}this.processing=false;this.startNextController()}))}else{this.submitForm()}}submitForm(){if(this.submitted){Array.from(this.element.querySelectorAll("input[type=file]")).forEach((t=>t.disabled=true));window.setTimeout((()=>{this.element.submit()}),10)}}init(t){const{id:e,file:i,controller:s}=t.detail;this.progressContainerTarget.insertAdjacentHTML("beforebegin",`\n      <progress-bar id="direct-upload-${e}" class="direct-upload--pending">${i.name}</progress-bar>\n    `);const r=document.getElementById(`direct-upload-${e}`);this.progressTargetMap[e]=r;this.controllers.push(s);this.startNextController()}start(t){this.progressTargetMap[t.detail.id].classList.remove("direct-upload--pending")}progress(t){const{id:e,progress:i}=t.detail;this.progressTargetMap[e].percent=i}error(t){t.preventDefault();const{id:e,error:i}=t.detail;const s=this.progressTargetMap[e];s.classList.add("direct-upload--error");s.title=i}end(t){this.progressTargetMap[t.detail.id].classList.add("direct-upload--complete")}removeUploadedFile(t){const e=t.detail;const i=e.controller?.directUpload?.id;if(i){document.getElementById(`direct-upload-${i}`).remove();delete this.progressTargetMap[i]}}}var o={exports:{}};(function(t,e){(function(e){{t.exports=e()}})((function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function i(t,e){var i=t[0],s=t[1],r=t[2],n=t[3];i+=(s&r|~s&n)+e[0]-680876936|0;i=(i<<7|i>>>25)+s|0;n+=(i&s|~i&r)+e[1]-389564586|0;n=(n<<12|n>>>20)+i|0;r+=(n&i|~n&s)+e[2]+606105819|0;r=(r<<17|r>>>15)+n|0;s+=(r&n|~r&i)+e[3]-1044525330|0;s=(s<<22|s>>>10)+r|0;i+=(s&r|~s&n)+e[4]-176418897|0;i=(i<<7|i>>>25)+s|0;n+=(i&s|~i&r)+e[5]+1200080426|0;n=(n<<12|n>>>20)+i|0;r+=(n&i|~n&s)+e[6]-1473231341|0;r=(r<<17|r>>>15)+n|0;s+=(r&n|~r&i)+e[7]-45705983|0;s=(s<<22|s>>>10)+r|0;i+=(s&r|~s&n)+e[8]+1770035416|0;i=(i<<7|i>>>25)+s|0;n+=(i&s|~i&r)+e[9]-1958414417|0;n=(n<<12|n>>>20)+i|0;r+=(n&i|~n&s)+e[10]-42063|0;r=(r<<17|r>>>15)+n|0;s+=(r&n|~r&i)+e[11]-1990404162|0;s=(s<<22|s>>>10)+r|0;i+=(s&r|~s&n)+e[12]+1804603682|0;i=(i<<7|i>>>25)+s|0;n+=(i&s|~i&r)+e[13]-40341101|0;n=(n<<12|n>>>20)+i|0;r+=(n&i|~n&s)+e[14]-1502002290|0;r=(r<<17|r>>>15)+n|0;s+=(r&n|~r&i)+e[15]+1236535329|0;s=(s<<22|s>>>10)+r|0;i+=(s&n|r&~n)+e[1]-165796510|0;i=(i<<5|i>>>27)+s|0;n+=(i&r|s&~r)+e[6]-1069501632|0;n=(n<<9|n>>>23)+i|0;r+=(n&s|i&~s)+e[11]+643717713|0;r=(r<<14|r>>>18)+n|0;s+=(r&i|n&~i)+e[0]-373897302|0;s=(s<<20|s>>>12)+r|0;i+=(s&n|r&~n)+e[5]-701558691|0;i=(i<<5|i>>>27)+s|0;n+=(i&r|s&~r)+e[10]+38016083|0;n=(n<<9|n>>>23)+i|0;r+=(n&s|i&~s)+e[15]-660478335|0;r=(r<<14|r>>>18)+n|0;s+=(r&i|n&~i)+e[4]-405537848|0;s=(s<<20|s>>>12)+r|0;i+=(s&n|r&~n)+e[9]+568446438|0;i=(i<<5|i>>>27)+s|0;n+=(i&r|s&~r)+e[14]-1019803690|0;n=(n<<9|n>>>23)+i|0;r+=(n&s|i&~s)+e[3]-187363961|0;r=(r<<14|r>>>18)+n|0;s+=(r&i|n&~i)+e[8]+1163531501|0;s=(s<<20|s>>>12)+r|0;i+=(s&n|r&~n)+e[13]-1444681467|0;i=(i<<5|i>>>27)+s|0;n+=(i&r|s&~r)+e[2]-51403784|0;n=(n<<9|n>>>23)+i|0;r+=(n&s|i&~s)+e[7]+1735328473|0;r=(r<<14|r>>>18)+n|0;s+=(r&i|n&~i)+e[12]-1926607734|0;s=(s<<20|s>>>12)+r|0;i+=(s^r^n)+e[5]-378558|0;i=(i<<4|i>>>28)+s|0;n+=(i^s^r)+e[8]-2022574463|0;n=(n<<11|n>>>21)+i|0;r+=(n^i^s)+e[11]+1839030562|0;r=(r<<16|r>>>16)+n|0;s+=(r^n^i)+e[14]-35309556|0;s=(s<<23|s>>>9)+r|0;i+=(s^r^n)+e[1]-1530992060|0;i=(i<<4|i>>>28)+s|0;n+=(i^s^r)+e[4]+1272893353|0;n=(n<<11|n>>>21)+i|0;r+=(n^i^s)+e[7]-155497632|0;r=(r<<16|r>>>16)+n|0;s+=(r^n^i)+e[10]-1094730640|0;s=(s<<23|s>>>9)+r|0;i+=(s^r^n)+e[13]+681279174|0;i=(i<<4|i>>>28)+s|0;n+=(i^s^r)+e[0]-358537222|0;n=(n<<11|n>>>21)+i|0;r+=(n^i^s)+e[3]-722521979|0;r=(r<<16|r>>>16)+n|0;s+=(r^n^i)+e[6]+76029189|0;s=(s<<23|s>>>9)+r|0;i+=(s^r^n)+e[9]-640364487|0;i=(i<<4|i>>>28)+s|0;n+=(i^s^r)+e[12]-421815835|0;n=(n<<11|n>>>21)+i|0;r+=(n^i^s)+e[15]+530742520|0;r=(r<<16|r>>>16)+n|0;s+=(r^n^i)+e[2]-995338651|0;s=(s<<23|s>>>9)+r|0;i+=(r^(s|~n))+e[0]-198630844|0;i=(i<<6|i>>>26)+s|0;n+=(s^(i|~r))+e[7]+1126891415|0;n=(n<<10|n>>>22)+i|0;r+=(i^(n|~s))+e[14]-1416354905|0;r=(r<<15|r>>>17)+n|0;s+=(n^(r|~i))+e[5]-57434055|0;s=(s<<21|s>>>11)+r|0;i+=(r^(s|~n))+e[12]+1700485571|0;i=(i<<6|i>>>26)+s|0;n+=(s^(i|~r))+e[3]-1894986606|0;n=(n<<10|n>>>22)+i|0;r+=(i^(n|~s))+e[10]-1051523|0;r=(r<<15|r>>>17)+n|0;s+=(n^(r|~i))+e[1]-2054922799|0;s=(s<<21|s>>>11)+r|0;i+=(r^(s|~n))+e[8]+1873313359|0;i=(i<<6|i>>>26)+s|0;n+=(s^(i|~r))+e[15]-30611744|0;n=(n<<10|n>>>22)+i|0;r+=(i^(n|~s))+e[6]-1560198380|0;r=(r<<15|r>>>17)+n|0;s+=(n^(r|~i))+e[13]+1309151649|0;s=(s<<21|s>>>11)+r|0;i+=(r^(s|~n))+e[4]-145523070|0;i=(i<<6|i>>>26)+s|0;n+=(s^(i|~r))+e[11]-1120210379|0;n=(n<<10|n>>>22)+i|0;r+=(i^(n|~s))+e[2]+718787259|0;r=(r<<15|r>>>17)+n|0;s+=(n^(r|~i))+e[9]-343485551|0;s=(s<<21|s>>>11)+r|0;t[0]=i+t[0]|0;t[1]=s+t[1]|0;t[2]=r+t[2]|0;t[3]=n+t[3]|0}function s(t){var e=[],i;for(i=0;i<64;i+=4){e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24)}return e}function r(t){var e=[],i;for(i=0;i<64;i+=4){e[i>>2]=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+(t[i+3]<<24)}return e}function n(t){var e=t.length,r=[1732584193,-271733879,-1732584194,271733878],n,o,a,h,c,l;for(n=64;n<=e;n+=64){i(r,s(t.substring(n-64,n)))}t=t.substring(n-64);o=t.length;a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<o;n+=1){a[n>>2]|=t.charCodeAt(n)<<(n%4<<3)}a[n>>2]|=128<<(n%4<<3);if(n>55){i(r,a);for(n=0;n<16;n+=1){a[n]=0}}h=e*8;h=h.toString(16).match(/(.*?)(.{0,8})$/);c=parseInt(h[2],16);l=parseInt(h[1],16)||0;a[14]=c;a[15]=l;i(r,a);return r}function o(t){var e=t.length,s=[1732584193,-271733879,-1732584194,271733878],n,o,a,h,c,l;for(n=64;n<=e;n+=64){i(s,r(t.subarray(n-64,n)))}t=n-64<e?t.subarray(n-64):new Uint8Array(0);o=t.length;a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<o;n+=1){a[n>>2]|=t[n]<<(n%4<<3)}a[n>>2]|=128<<(n%4<<3);if(n>55){i(s,a);for(n=0;n<16;n+=1){a[n]=0}}h=e*8;h=h.toString(16).match(/(.*?)(.{0,8})$/);c=parseInt(h[2],16);l=parseInt(h[1],16)||0;a[14]=c;a[15]=l;i(s,a);return s}function a(t){var i="",s;for(s=0;s<4;s+=1){i+=e[t>>s*8+4&15]+e[t>>s*8&15]}return i}function h(t){var e;for(e=0;e<t.length;e+=1){t[e]=a(t[e])}return t.join("")}if(h(n("hello"))!=="5d41402abc4b2a76b9719d911017c592");if(typeof ArrayBuffer!=="undefined"&&!ArrayBuffer.prototype.slice){(function(){function e(t,e){t=t|0||0;if(t<0){return Math.max(t+e,0)}return Math.min(t,e)}ArrayBuffer.prototype.slice=function(i,s){var r=this.byteLength,n=e(i,r),o=r,a,h,c,l;if(s!==t){o=e(s,r)}if(n>o){return new ArrayBuffer(0)}a=o-n;h=new ArrayBuffer(a);c=new Uint8Array(h);l=new Uint8Array(this,n,a);c.set(l);return h}})()}function c(t){if(/[\u0080-\uFFFF]/.test(t)){t=unescape(encodeURIComponent(t))}return t}function l(t,e){var i=t.length,s=new ArrayBuffer(i),r=new Uint8Array(s),n;for(n=0;n<i;n+=1){r[n]=t.charCodeAt(n)}return e?r:s}function d(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function f(t,e,i){var s=new Uint8Array(t.byteLength+e.byteLength);s.set(new Uint8Array(t));s.set(new Uint8Array(e),t.byteLength);return s}function u(t){var e=[],i=t.length,s;for(s=0;s<i-1;s+=2){e.push(parseInt(t.substr(s,2),16))}return String.fromCharCode.apply(String,e)}function p(){this.reset()}p.prototype.append=function(t){this.appendBinary(c(t));return this};p.prototype.appendBinary=function(t){this._buff+=t;this._length+=t.length;var e=this._buff.length,r;for(r=64;r<=e;r+=64){i(this._hash,s(this._buff.substring(r-64,r)))}this._buff=this._buff.substring(r-64);return this};p.prototype.end=function(t){var e=this._buff,i=e.length,s,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n;for(s=0;s<i;s+=1){r[s>>2]|=e.charCodeAt(s)<<(s%4<<3)}this._finish(r,i);n=h(this._hash);if(t){n=u(n)}this.reset();return n};p.prototype.reset=function(){this._buff="";this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}};p.prototype.setState=function(t){this._buff=t.buff;this._length=t.length;this._hash=t.hash;return this};p.prototype.destroy=function(){delete this._hash;delete this._buff;delete this._length};p.prototype._finish=function(t,e){var s=e,r,n,o;t[s>>2]|=128<<(s%4<<3);if(s>55){i(this._hash,t);for(s=0;s<16;s+=1){t[s]=0}}r=this._length*8;r=r.toString(16).match(/(.*?)(.{0,8})$/);n=parseInt(r[2],16);o=parseInt(r[1],16)||0;t[14]=n;t[15]=o;i(this._hash,t)};p.hash=function(t,e){return p.hashBinary(c(t),e)};p.hashBinary=function(t,e){var i=n(t),s=h(i);return e?u(s):s};p.ArrayBuffer=function(){this.reset()};p.ArrayBuffer.prototype.append=function(t){var e=f(this._buff.buffer,t),s=e.length,n;this._length+=t.byteLength;for(n=64;n<=s;n+=64){i(this._hash,r(e.subarray(n-64,n)))}this._buff=n-64<s?new Uint8Array(e.buffer.slice(n-64)):new Uint8Array(0);return this};p.ArrayBuffer.prototype.end=function(t){var e=this._buff,i=e.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r,n;for(r=0;r<i;r+=1){s[r>>2]|=e[r]<<(r%4<<3)}this._finish(s,i);n=h(this._hash);if(t){n=u(n)}this.reset();return n};p.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};p.ArrayBuffer.prototype.getState=function(){var t=p.prototype.getState.call(this);t.buff=d(t.buff);return t};p.ArrayBuffer.prototype.setState=function(t){t.buff=l(t.buff,true);return p.prototype.setState.call(this,t)};p.ArrayBuffer.prototype.destroy=p.prototype.destroy;p.ArrayBuffer.prototype._finish=p.prototype._finish;p.ArrayBuffer.hash=function(t,e){var i=o(new Uint8Array(t)),s=h(i);return e?u(s):s};return p}))})(o);var a=o.exports;const h=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class c{static create(t,e){const i=new c(t);i.create(e)}constructor(t){this.file=t;this.chunkSize=2097152;this.chunkCount=Math.ceil(this.file.size/this.chunkSize);this.chunkIndex=0}create(t){this.callback=t;this.md5Buffer=new a.ArrayBuffer;this.fileReader=new FileReader;this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t)));this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t)));this.readNextChunk()}fileReaderDidLoad(t){this.md5Buffer.append(t.target.result);if(!this.readNextChunk()){const t=this.md5Buffer.end(true);const e=btoa(t);this.callback(null,e)}}fileReaderDidError(t){this.callback(`Error reading ${this.file.name}`)}readNextChunk(){if(this.chunkIndex<this.chunkCount||this.chunkIndex==0&&this.chunkCount==0){const t=this.chunkIndex*this.chunkSize;const e=Math.min(t+this.chunkSize,this.file.size);const i=h.call(this.file,t,e);this.fileReader.readAsArrayBuffer(i);this.chunkIndex++;return true}else{return false}}}function l(t){const e=f(document.head,`meta[name="${t}"]`);if(e){return e.getAttribute("content")}}function d(t,e){if(typeof t=="string"){e=t;t=document}const i=t.querySelectorAll(e);return p(i)}function f(t,e){if(typeof t=="string"){e=t;t=document}return t.querySelector(e)}function u(t,e,i={}){const{disabled:s}=t;const{bubbles:r,cancelable:n,detail:o}=i;const a=document.createEvent("Event");a.initEvent(e,r||true,n||true);a.detail=o||{};try{t.disabled=false;t.dispatchEvent(a)}finally{t.disabled=s}return a}function p(t){if(Array.isArray(t)){return t}else if(Array.from){return Array.from(t)}else{return[].slice.call(t)}}class g{constructor(t,e,i,s={}){this.file=t;this.attributes={filename:t.name,content_type:t.type||"application/octet-stream",byte_size:t.size,checksum:e};this.xhr=new XMLHttpRequest;this.xhr.open("POST",i,true);this.xhr.responseType="json";this.xhr.setRequestHeader("Content-Type","application/json");this.xhr.setRequestHeader("Accept","application/json");this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");Object.keys(s).forEach((t=>{this.xhr.setRequestHeader(t,s[t])}));const r=l("csrf-token");if(r!=undefined){this.xhr.setRequestHeader("X-CSRF-Token",r)}this.xhr.addEventListener("load",(t=>this.requestDidLoad(t)));this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}get status(){return this.xhr.status}get response(){const{responseType:t,response:e}=this.xhr;if(t=="json"){return e}else{return JSON.parse(e)}}create(t){this.callback=t;this.xhr.send(JSON.stringify({blob:this.attributes}))}requestDidLoad(t){if(this.status>=200&&this.status<300){const{response:t}=this;const{direct_upload:e}=t;delete t.direct_upload;this.attributes=t;this.directUploadData=e;this.callback(null,this.toJSON())}else{this.requestDidError(t)}}requestDidError(t){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSON(){const t={};for(const e in this.attributes){t[e]=this.attributes[e]}return t}}class b{constructor(t){this.blob=t;this.file=t.file;const{url:e,headers:i}=t.directUploadData;this.xhr=new XMLHttpRequest;this.xhr.open("PUT",e,true);this.xhr.responseType="text";for(const t in i){this.xhr.setRequestHeader(t,i[t])}this.xhr.addEventListener("load",(t=>this.requestDidLoad(t)));this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}create(t){this.callback=t;this.xhr.send(this.file.slice())}requestDidLoad(t){const{status:e,response:i}=this.xhr;if(e>=200&&e<300){this.callback(null,i)}else{this.requestDidError(t)}}requestDidError(t){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let m=0;class v{constructor(t,e,i,s={}){this.id=++m;this.file=t;this.url=e;this.delegate=i;this.customHeaders=s}create(t){c.create(this.file,((e,i)=>{if(e){t(e);return}const s=new g(this.file,i,this.url,this.customHeaders);w(this.delegate,"directUploadWillCreateBlobWithXHR",s.xhr);s.create((e=>{if(e){t(e)}else{const e=new b(s);w(this.delegate,"directUploadWillStoreFileWithXHR",e.xhr);e.create((e=>{if(e){t(e)}else{t(null,s.toJSON())}}))}}))}))}}function w(t,e,...i){if(t&&typeof t[e]=="function"){return t[e](...i)}}let y=class t{constructor(t,e){this.input=t;this.file=e;this.directUpload=new v(this.file,this.url,this);this.dispatch("initialize")}start(t){const e=document.createElement("input");e.type="hidden";e.name=this.input.name;this.input.insertAdjacentElement("beforebegin",e);this.dispatch("start");this.directUpload.create(((i,s)=>{if(i){e.parentNode.removeChild(e);this.dispatchError(i)}else{e.value=s.signed_id}this.dispatch("end");t(i)}))}uploadRequestDidProgress(t){const e=t.loaded/t.total*100;if(e){this.dispatch("progress",{progress:e})}}get url(){return this.input.getAttribute("data-direct-upload-url")}dispatch(t,e={}){e.file=this.file;e.id=this.directUpload.id;return u(this.input,`direct-upload:${t}`,{detail:e})}dispatchError(t){const e=this.dispatch("error",{error:t});if(!e.defaultPrevented){alert(t)}}directUploadWillCreateBlobWithXHR(t){this.dispatch("before-blob-request",{xhr:t})}directUploadWillStoreFileWithXHR(t){this.dispatch("before-storage-request",{xhr:t});t.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}};const x="input[type=file][data-direct-upload-url]:not([disabled])";class k{constructor(t){this.form=t;this.inputs=d(t,x).filter((t=>t.files.length))}start(t){const e=this.createDirectUploadControllers();const i=()=>{const s=e.shift();if(s){s.start((e=>{if(e){t(e);this.dispatch("end")}else{i()}}))}else{t();this.dispatch("end")}};this.dispatch("start");i()}createDirectUploadControllers(){const t=[];this.inputs.forEach((e=>{p(e.files).forEach((i=>{const s=new y(e,i);t.push(s)}))}));return t}dispatch(t,e={}){return u(this.form,`direct-uploads:${t}`,{detail:e})}}const $="data-direct-uploads-processing";const T=new WeakMap;let C=false;function E(){if(!C){C=true;document.addEventListener("click",A,true);document.addEventListener("submit",U,true);document.addEventListener("ajax:before",R)}}function A(t){const e=t.target.closest("button, input");if(e&&e.type==="submit"&&e.form){T.set(e.form,e)}}function U(t){j(t)}function R(t){if(t.target.tagName=="FORM"){j(t)}}function j(t){const e=t.target;if(e.hasAttribute($)){t.preventDefault();return}const i=new k(e);const{inputs:s}=i;if(s.length){t.preventDefault();e.setAttribute($,"");s.forEach(O);i.start((t=>{e.removeAttribute($);if(t){s.forEach(B)}else{M(e)}}))}}function M(t){let e=T.get(t)||f(t,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=false;e.focus();e.click();e.disabled=t}else{e=document.createElement("input");e.type="submit";e.style.display="none";t.appendChild(e);e.click();t.removeChild(e)}T.delete(t)}function O(t){t.disabled=true}function B(t){t.disabled=false}function F(){if(window.ActiveStorage){E()}}setTimeout(F,1);class S{uploadedFile;file;directUpload;recordXHR;uploadXHR;callback=null;constructor(t){this.uploadedFile=t;this.file=this.uploadedFile["file"];this.directUpload=new v(this.file,this.uploadedFile.url,this)}cancel(){this.directUpload.url=null;this.abortXHR(this.recordXHR);this.abortXHR(this.uploadXHR)}abortXHR(t){if(!t)return;t.addEventListener("abort",(()=>{this.complete("aborted",{})}));t.abort()}start(t){this.callback=t;this.dispatch("start");this.directUpload.create(((t,e)=>{this.complete(t,e)}))}complete(t,e){if(t){this.dispatchError(t)}this.dispatch("end");this.callback(t)}uploadRequestDidProgress(t){const e=t.loaded/t.total*100;if(e){this.dispatch("progress",{progress:e})}}dispatch(t,e={}){return L(this.uploadedFile,`direct-upload:${t}`,{detail:{...e,file:this.file,id:this.directUpload.id}})}dispatchError(t){this.dispatch("error",{error:t})}directUploadWillCreateBlobWithXHR(t){this.recordXHR=t;this.dispatch("before-blob-request",{xhr:t})}directUploadWillStoreFileWithXHR(t){this.uploadXHR=t;this.uploadedFile.value=this.recordXHR.response.signed_id;this.dispatch("before-storage-request",{xhr:t});t.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}}function L(t,e,i={}){const{disabled:s}=t;const{bubbles:r,cancelable:n,detail:o}=i;const a=document.createEvent("Event");a.initEvent(e,r||true,n||true);a.detail=o||{};try{t.disabled=false;t.dispatchEvent(a)}finally{t.disabled=s}return a}class z{uploadedFile;constructor(t){this.uploadedFile=t}get errors(){if(this.#t)return this.#t;this.#t=[];if(!this.checkValidity()){this.#t.push(this.errorMessage)}return this.#t}#t;checkValidity(){if(!this.uploadedFile.max)return true;return this.uploadedFile.size<=this.uploadedFile.max}get errorMessage(){return[`Must be smaller than ${this.formatBytes(this.uploadedFile.max)},`,`and "${this.uploadedFile.filename}" is ${this.formatBytes(this.uploadedFile.size)}.`,`Please attach a smaller file.`].join(" ")}formatBytes(t,e=2){if(t===0)return"0 Bytes";const i=1024;const s=e<0?0:e;const r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];const n=Math.floor(Math.log(t)/Math.log(i));return parseFloat((t/Math.pow(i,n)).toFixed(s))+r[n]}}class q{uploadedFile;constructor(t){this.uploadedFile=t}get errors(){if(this.#t)return this.#t;this.#t=[];const t=this.uploadedFile.accepts?this.uploadedFile.accepts.split(/,\s*/):[];if(t.length>0&&!t.includes(this.uploadedFile.filetype)){this.#t.push(`Must be a ${this.joinWords(t)}.`)}return this.#t}#t;joinWords(t){if(t.length>=3){return(t.slice(0,-1)+[`or ${t.at(-1)}`]).join(", ")}else{return t.join(" or ")}}}var P={image:["ase","art","bmp","blp","cd5","cit","cpt","cr2","cut","dds","dib","djvu","egt","exif","gif","gpl","grf","icns","ico","iff","jng","jpeg","jpg","jfif","jp2","jps","lbm","max","miff","mng","msp","nef","nitf","ota","pbm","pc1","pc2","pc3","pcf","pcx","pdn","pgm","PI1","PI2","PI3","pict","pct","pnm","pns","ppm","psb","psd","pdd","psp","px","pxm","pxr","qfx","raw","rle","sct","sgi","rgb","int","bw","tga","tiff","tif","vtf","xbm","xcf","xpm","3dv","amf","ai","awg","cgm","cdr","cmx","dxf","e2d","egt","eps","fs","gbr","odg","svg","stl","vrml","x3d","sxd","v2d","vnd","wmf","emf","art","xar","png","webp","jxr","hdp","wdp","cur","ecw","iff","lbm","liff","nrrd","pam","pcx","pgf","sgi","rgb","rgba","bw","int","inta","sid","ras","sun","tga","heic","heif"],video:["3g2","3gp","3gpp","aaf","asf","avchd","avi","drc","flv","m2v","m3u8","m4p","m4v","mkv","mng","mov","mp2","mp4","mpe","mpeg","mpg","mpv","mxf","nsv","ogg","ogv","qt","rm","rmvb","roq","svi","vob","webm","wmv","yuv"],pdf:["pdf"],getFileType:function(t){const e=t.toString().split(".").at(-1).toLowerCase().trim();if(this.video.includes(e))return"video";if(this.image.includes(e))return"image";if(this.pdf.includes(e))return"pdf";return"unknown"}};class I{constructor(t){this.response=t}get statusCode(){return this.response.status}get redirected(){return this.response.redirected}get ok(){return this.response.ok}get unauthenticated(){return this.statusCode===401}get unprocessableEntity(){return this.statusCode===422}get authenticationURL(){return this.response.headers.get("WWW-Authenticate")}get contentType(){const t=this.response.headers.get("Content-Type")||"";return t.replace(/;.*$/,"")}get headers(){return this.response.headers}get html(){if(this.contentType.match(/^(application|text)\/(html|xhtml\+xml)$/)){return this.text}return Promise.reject(new Error(`Expected an HTML response but got "${this.contentType}" instead`))}get json(){if(this.contentType.match(/^application\/.*json$/)){return this.responseJson||(this.responseJson=this.response.json())}return Promise.reject(new Error(`Expected a JSON response but got "${this.contentType}" instead`))}get text(){return this.responseText||(this.responseText=this.response.text())}get isTurboStream(){return this.contentType.match(/^text\/vnd\.turbo-stream\.html/)}async renderTurboStream(){if(this.isTurboStream){if(window.Turbo){await window.Turbo.renderStreamMessage(await this.text)}else{console.warn("You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js")}}else{return Promise.reject(new Error(`Expected a Turbo Stream response but got "${this.contentType}" instead`))}}}class D{static register(t){this.interceptor=t}static get(){return this.interceptor}static reset(){this.interceptor=undefined}}function H(t){const e=document.cookie?document.cookie.split("; "):[];const i=`${encodeURIComponent(t)}=`;const s=e.find((t=>t.startsWith(i)));if(s){const t=s.split("=").slice(1).join("=");if(t){return decodeURIComponent(t)}}}function W(t){const e={};for(const i in t){const s=t[i];if(s!==undefined){e[i]=s}}return e}function X(t){const e=document.head.querySelector(`meta[name="${t}"]`);return e&&e.content}function N(t){return[...t].reduce(((t,[e,i])=>t.concat(typeof i==="string"?[[e,i]]:[])),[])}function _(t,e){for(const[i,s]of e){if(s instanceof window.File)continue;if(t.has(i)){t.delete(i);t.set(i,s)}else{t.append(i,s)}}}class J{constructor(t,e,i={}){this.method=t;this.options=i;this.originalUrl=e.toString()}async perform(){try{const t=D.get();if(t){await t(this)}}catch(t){console.error(t)}const t=new I(await window.fetch(this.url,this.fetchOptions));if(t.unauthenticated&&t.authenticationURL){return Promise.reject(window.location.href=t.authenticationURL)}if(t.ok&&t.isTurboStream){await t.renderTurboStream()}return t}addHeader(t,e){const i=this.additionalHeaders;i[t]=e;this.options.headers=i}get fetchOptions(){return{method:this.method.toUpperCase(),headers:this.headers,body:this.formattedBody,signal:this.signal,credentials:"same-origin",redirect:this.redirect}}get headers(){return W(Object.assign({"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":this.csrfToken,"Content-Type":this.contentType,Accept:this.accept},this.additionalHeaders))}get csrfToken(){return H(X("csrf-param"))||X("csrf-token")}get contentType(){if(this.options.contentType){return this.options.contentType}else if(this.body==null||this.body instanceof window.FormData){return undefined}else if(this.body instanceof window.File){return this.body.type}return"application/json"}get accept(){switch(this.responseKind){case"html":return"text/html, application/xhtml+xml";case"turbo-stream":return"text/vnd.turbo-stream.html, text/html, application/xhtml+xml";case"json":return"application/json, application/vnd.api+json";default:return"*/*"}}get body(){return this.options.body}get query(){const t=(this.originalUrl.split("?")[1]||"").split("#")[0];const e=new URLSearchParams(t);let i=this.options.query;if(i instanceof window.FormData){i=N(i)}else if(i instanceof window.URLSearchParams){i=i.entries()}else{i=Object.entries(i||{})}_(e,i);const s=e.toString();return s.length>0?`?${s}`:""}get url(){return this.originalUrl.split("?")[0].split("#")[0]+this.query}get responseKind(){return this.options.responseKind||"html"}get signal(){return this.options.signal}get redirect(){return this.options.redirect||"follow"}get additionalHeaders(){return this.options.headers||{}}get formattedBody(){const t=Object.prototype.toString.call(this.body)==="[object String]";const e=this.headers["Content-Type"]==="application/json";if(e&&!t){return JSON.stringify(this.body)}return this.body}}const V=(t,e,i)=>{const s=new J(t,e,{headers:{Accept:"application/json"},body:i});return s.perform().then((t=>{if(t.response.ok){return t.json}else{return t}}))};const G=(t,e)=>V("get",t,e);var Y=11;function K(t,e){var i=e.attributes;var s;var r;var n;var o;var a;if(e.nodeType===Y||t.nodeType===Y){return}for(var h=i.length-1;h>=0;h--){s=i[h];r=s.name;n=s.namespaceURI;o=s.value;if(n){r=s.localName||r;a=t.getAttributeNS(n,r);if(a!==o){if(s.prefix==="xmlns"){r=s.name}t.setAttributeNS(n,r,o)}}else{a=t.getAttribute(r);if(a!==o){t.setAttribute(r,o)}}}var c=t.attributes;for(var l=c.length-1;l>=0;l--){s=c[l];r=s.name;n=s.namespaceURI;if(n){r=s.localName||r;if(!e.hasAttributeNS(n,r)){t.removeAttributeNS(n,r)}}else{if(!e.hasAttribute(r)){t.removeAttribute(r)}}}}var Z;var Q="http://www.w3.org/1999/xhtml";var tt=typeof document==="undefined"?undefined:document;var et=!!tt&&"content"in tt.createElement("template");var it=!!tt&&tt.createRange&&"createContextualFragment"in tt.createRange();function st(t){var e=tt.createElement("template");e.innerHTML=t;return e.content.childNodes[0]}function rt(t){if(!Z){Z=tt.createRange();Z.selectNode(tt.body)}var e=Z.createContextualFragment(t);return e.childNodes[0]}function nt(t){var e=tt.createElement("body");e.innerHTML=t;return e.childNodes[0]}function ot(t){t=t.trim();if(et){return st(t)}else if(it){return rt(t)}return nt(t)}function at(t,e){var i=t.nodeName;var s=e.nodeName;var r,n;if(i===s){return true}r=i.charCodeAt(0);n=s.charCodeAt(0);if(r<=90&&n>=97){return i===s.toUpperCase()}else if(n<=90&&r>=97){return s===i.toUpperCase()}else{return false}}function ht(t,e){return!e||e===Q?tt.createElement(t):tt.createElementNS(e,t)}function ct(t,e){var i=t.firstChild;while(i){var s=i.nextSibling;e.appendChild(i);i=s}return e}function lt(t,e,i){if(t[i]!==e[i]){t[i]=e[i];if(t[i]){t.setAttribute(i,"")}else{t.removeAttribute(i)}}}var dt={OPTION:function(t,e){var i=t.parentNode;if(i){var s=i.nodeName.toUpperCase();if(s==="OPTGROUP"){i=i.parentNode;s=i&&i.nodeName.toUpperCase()}if(s==="SELECT"&&!i.hasAttribute("multiple")){if(t.hasAttribute("selected")&&!e.selected){t.setAttribute("selected","selected");t.removeAttribute("selected")}i.selectedIndex=-1}}lt(t,e,"selected")},INPUT:function(t,e){lt(t,e,"checked");lt(t,e,"disabled");if(t.value!==e.value){t.value=e.value}if(!e.hasAttribute("value")){t.removeAttribute("value")}},TEXTAREA:function(t,e){var i=e.value;if(t.value!==i){t.value=i}var s=t.firstChild;if(s){var r=s.nodeValue;if(r==i||!i&&r==t.placeholder){return}s.nodeValue=i}},SELECT:function(t,e){if(!e.hasAttribute("multiple")){var i=-1;var s=0;var r=t.firstChild;var n;var o;while(r){o=r.nodeName&&r.nodeName.toUpperCase();if(o==="OPTGROUP"){n=r;r=n.firstChild;if(!r){r=n.nextSibling;n=null}}else{if(o==="OPTION"){if(r.hasAttribute("selected")){i=s;break}s++}r=r.nextSibling;if(!r&&n){r=n.nextSibling;n=null}}}t.selectedIndex=i}}};var ft=1;var ut=11;var pt=3;var gt=8;function bt(){}function mt(t){if(t){return t.getAttribute&&t.getAttribute("id")||t.id}}function vt(t){return function e(i,s,r){if(!r){r={}}if(typeof s==="string"){if(i.nodeName==="#document"||i.nodeName==="HTML"||i.nodeName==="BODY"){var n=s;s=tt.createElement("html");s.innerHTML=n}else{s=ot(s)}}else if(s.nodeType===ut){s=s.firstElementChild}var o=r.getNodeKey||mt;var a=r.onBeforeNodeAdded||bt;var h=r.onNodeAdded||bt;var c=r.onBeforeElUpdated||bt;var l=r.onElUpdated||bt;var d=r.onBeforeNodeDiscarded||bt;var f=r.onNodeDiscarded||bt;var u=r.onBeforeElChildrenUpdated||bt;var p=r.skipFromChildren||bt;var g=r.addChild||function(t,e){return t.appendChild(e)};var b=r.childrenOnly===true;var m=Object.create(null);var v=[];function w(t){v.push(t)}function y(t,e){if(t.nodeType===ft){var i=t.firstChild;while(i){var s=undefined;if(e&&(s=o(i))){w(s)}else{f(i);if(i.firstChild){y(i,e)}}i=i.nextSibling}}}function x(t,e,i){if(d(t)===false){return}if(e){e.removeChild(t)}f(t);y(t,i)}function k(t){if(t.nodeType===ft||t.nodeType===ut){var e=t.firstChild;while(e){var i=o(e);if(i){m[i]=e}k(e);e=e.nextSibling}}}k(i);function $(t){h(t);var e=t.firstChild;while(e){var i=e.nextSibling;var s=o(e);if(s){var r=m[s];if(r&&at(e,r)){e.parentNode.replaceChild(r,e);C(r,e)}else{$(e)}}else{$(e)}e=i}}function T(t,e,i){while(e){var s=e.nextSibling;if(i=o(e)){w(i)}else{x(e,t,true)}e=s}}function C(e,i,s){var r=o(i);if(r){delete m[r]}if(!s){var n=c(e,i);if(n===false){return}else if(n instanceof HTMLElement){e=n;k(e)}t(e,i);l(e);if(u(e,i)===false){return}}if(e.nodeName!=="TEXTAREA"){E(e,i)}else{dt.TEXTAREA(e,i)}}function E(t,e){var i=p(t,e);var s=e.firstChild;var r=t.firstChild;var n;var h;var c;var l;var d;t:while(s){l=s.nextSibling;n=o(s);while(!i&&r){c=r.nextSibling;if(s.isSameNode&&s.isSameNode(r)){s=l;r=c;continue t}h=o(r);var f=r.nodeType;var u=undefined;if(f===s.nodeType){if(f===ft){if(n){if(n!==h){if(d=m[n]){if(c===d){u=false}else{t.insertBefore(d,r);if(h){w(h)}else{x(r,t,true)}r=d;h=o(r)}}else{u=false}}}else if(h){u=false}u=u!==false&&at(r,s);if(u){C(r,s)}}else if(f===pt||f==gt){u=true;if(r.nodeValue!==s.nodeValue){r.nodeValue=s.nodeValue}}}if(u){s=l;r=c;continue t}if(h){w(h)}else{x(r,t,true)}r=c}if(n&&(d=m[n])&&at(d,s)){if(!i){g(t,d)}C(d,s)}else{var b=a(s);if(b!==false){if(b){s=b}if(s.actualize){s=s.actualize(t.ownerDocument||tt)}g(t,s);$(s)}}s=l;r=c}T(t,r,h);var v=dt[t.nodeName];if(v){v(t,e)}}var A=i;var U=A.nodeType;var R=s.nodeType;if(!b){if(U===ft){if(R===ft){if(!at(i,s)){f(i);A=ct(i,ht(s.nodeName,s.namespaceURI))}}else{A=s}}else if(U===pt||U===gt){if(R===U){if(A.nodeValue!==s.nodeValue){A.nodeValue=s.nodeValue}return A}else{A=s}}}if(A===s){f(i)}else{if(s.isSameNode&&s.isSameNode(A)){return}C(A,s,b);if(v){for(var j=0,M=v.length;j<M;j++){var O=m[v[j]];if(O){x(O,O.parentNode,false)}}}}if(!b&&A!==i&&i.parentNode){if(A.actualize){A=A.actualize(i.ownerDocument||tt)}i.parentNode.replaceChild(A,i)}return A}}var wt=vt(K);function yt(t){const e=document.createElement("div");wt(e,`<div>${t}</div>`);return e.children[0]}function xt(t,e){const i=t.findIndex((t=>t===e));if(i!==-1){t.splice(i,1)}}class kt extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"});this._percent=0}connectedCallback(){this.render();this.updateBar()}get percent(){return this._percent}set percent(t){this._percent=Number(t)||0;this.setAttribute("percent",this._percent);this.updateBar()}static get observedAttributes(){return["percent"]}attributeChangedCallback(t,e,i){if(t==="percent"){this._percent=Number(i)||0;this.updateBar()}}updateBar(){const t=this.shadowRoot?.querySelector(".bar");if(t){t.style.width=`${this._percent}%`}}render(){this.shadowRoot.innerHTML=`\n      <style>\n        :host {\n          --progress-color: rgb(57, 137, 39);\n          --progress-duration: 120ms;\n          --bar-height: 32px;\n          --bar-radius: 4px;\n          --bar-padding: 8px;\n\n          display: block;\n          position: relative;\n          padding: var(--bar-padding);\n          border: 1px solid #999;\n          border-radius: var(--bar-radius);\n        }\n\n        .bar {\n          position: absolute;\n          top: 0;\n          left: 0;\n          height: 100%;\n          background: var(--progress-color);\n          width: 0%;\n          transition: width var(--progress-duration) ease, opacity 60ms ease;\n          border-radius: var(--bar-radius);\n        }\n\n        .content {\n          position: relative;\n          display: block;\n          color: white;\n          font-size: 13px;\n          z-index: 1;\n        }\n      </style>\n\n      <div class="bar"></div>\n      <span class="content">\n        <slot></slot>\n      </span>\n    `}}customElements.define("progress-bar",kt);const $t=':host{display:block;width:100%;max-width:100%;font-size:13px}figure{margin:0}.progress-details{position:relative;display:flex;align-items:center}progress-bar{flex:1 0;padding:0 10px}progress-bar.pending{opacity:0.5}progress-bar.complete{opacity:0.8}progress-bar:not(.complete)+.progress-icon{display:none}progress-bar.complete+.progress-icon{content:url(\'data:image/svg+xml;utf8,<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve"><g><path d="M6.3,9.1c0.2,0,0.5,0.1,0.7,0.4c0.5,0.5,1,1,1.4,1.4c0.3,0.3,0.3,0.3,0.6,0c1.4-1.3,2.7-2.6,4-3.9c0.3-0.3,0.6-0.4,1-0.4 c0.5,0.1,0.9,0.6,0.7,1.1c-0.1,0.2-0.2,0.4-0.3,0.6c-1.6,1.6-3.2,3.2-4.8,4.8c-0.5,0.5-1,0.5-1.6,0c-0.8-0.7-1.5-1.5-2.3-2.3 c-0.3-0.3-0.5-0.6-0.3-1.1C5.5,9.3,5.8,9.1,6.3,9.1z"/></g></svg>\');filter:invert(100%)}.progress-icon{display:inline-block;flex:0 0 20px;width:28px;height:28px;background-size:contain;position:absolute;right:30px;z-index:1}progress-bar.error{background:#f8b3b1;background:rgba(74, 70, 70, 0.25);opacity:1}.progress-bar a{color:#fff}.download-link{padding-right:20px;color:#fff}.remove-media{display:inline-block;content:url(\'data:image/svg+xml;utf8,<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 40 40" style="enable-background:new 0 0 40 40;" xml:space="preserve"><g><path d="M0,19.9C0.2,8.5,9.2-0.1,20.1,0C31.8,0.1,40.2,9.5,40,20.4c-0.2,11-8.9,19.7-20.1,19.6C8,39.9,0,30.5,0,19.9z M20,3.7 c-9,0-16.3,7-16.3,16.2C3.7,29,10.9,36.3,20,36.3c9,0,16.3-7.1,16.4-16.3C36.3,11,29.2,3.8,20,3.7z"/><path d="M17.3,20c-0.2-0.2-0.3-0.4-0.5-0.6c-1-1-2-1.9-2.9-2.9c-0.5-0.5-0.8-1.1-0.7-1.9c0.1-0.7,0.5-1.2,1.2-1.4 c0.8-0.2,1.5,0,2.1,0.6c1,1,2,2,3,3.1c0.3,0.4,0.6,0.3,0.9,0c1-1,2-2,3-3c0.3-0.3,0.7-0.5,1.1-0.6c0.8-0.2,1.6,0.1,2,0.8 c0.4,0.8,0.3,1.7-0.4,2.4c-1,1-2,2-3,3c-0.2,0.2-0.3,0.4-0.5,0.6c1.2,1.2,2.3,2.3,3.4,3.4c0.6,0.6,0.9,1.3,0.6,2.2 c-0.4,1.1-1.7,1.6-2.6,1c-0.3-0.2-0.5-0.4-0.8-0.6c-1-1-1.9-1.9-2.9-2.9c-0.3-0.3-0.5-0.3-0.9,0c-1,1-2,2.1-3,3 c-0.4,0.4-1,0.6-1.5,0.8c-0.6,0.1-1.2-0.2-1.5-0.8c-0.4-0.6-0.5-1.3-0.1-1.9c0.2-0.3,0.4-0.5,0.6-0.7C15.1,22.3,16.2,21.2,17.3,20z "/></g></svg>\');flex:0 0 25px;width:25px;height:20px;align-items:center;opacity:0.25}.remove-media:hover{opacity:1;filter:invert(50%)sepia(100%)saturate(10000%)}.remove-media span{display:inline-block;text-indent:-9999px;color:transparent}';let Tt=0;const Ct=class{get el(){return t(this)}name;accepts;max;url;value="";filename;src;filetype;size;state="complete";percent=100;preview=true;validationMessage;removeEvent;removeClicked=t=>{t.stopPropagation();t.preventDefault();this.controller?.cancel();this.removeEvent.emit(this)};inputTarget;controller;_file;uid;constructor(t){e(this,t);this.removeEvent=i(this,"uploaded-file:remove");this.uid=Tt++;this.inputTarget=yt(`<input id="input-target-${this.uid}">`)}componentWillLoad(){this.el.appendChild(this.inputTarget);this.setMissingFiletype()}get file(){return this._file}set file(t){this.src=URL.createObjectURL(t);this.filename=t.name;this.size=t.size;this.state="pending";this.percent=0;this._file=t}set signedId(t){if(this.value!==t){G(`/rails/active_storage/blobs/info/${t}`).then((e=>{this.src=`/rails/active_storage/blobs/redirect/${t}/${e.filename}`;this.filename=e.filename;this.size=e.byte_size;this.state="complete";this.percent=100;this.value=t}))}}setMissingFiletype(t,e){if(!this.filetype&&this.filename){this.filetype=P.getFileType(this.filename)}}start(t){this.state="pending";this.percent=0}progress(t){const{progress:e}=t.detail;this.percent=e}error(t){t.preventDefault();const{error:e}=t.detail;this.state="error";this.inputTarget.setCustomValidity(e)}end(t){if(this.state!=="error"){this.state="complete";this.percent=100}}render(){return s(r,{key:"fcfc0f35f9ea1709fa64840c6e72ad078a67a630"},s("slot",{key:"d71052b9e2aa323eeecbf86296e20e9c4df3acf4"}),s("figure",{key:"aa373e5ded54689c29d07505b19f629a1d687029"},s("div",{key:"7e84b497f44ad9362c866d30b7a044a44307cbd4",class:"progress-details"},s("progress-bar",{key:"6775ae55eed138754d8d66e9e2b2d6e0bb477c59",percent:this.percent,class:this.state},s("a",{key:"d3f489b8930818c06132ba93a69875409277dbb3",class:"download-link",href:this.src,download:this.filename,onClick:t=>t.stopPropagation()},this.filename)),s("span",{key:"25c6d686db7df4b80e3bfbdcd62ef75bd8c66be5",class:"progress-icon"}),s("a",{key:"e397f1139d7e565a8aacb35955fe79a2a2bd746d",class:"remove-media",onClick:this.removeClicked,href:"#"},s("span",{key:"91617315ad71b68fa6e98e1cae979ed1450f96ba"},"Remove media"))),this.preview?s("file-preview",{src:this.src,filetype:this.filetype}):""))}componentDidRender(){wt(this.inputTarget,`\n      <input\n        id="input-target-${this.uid}"\n        style="opacity: 0.01; width: 1px; height: 1px; z-index: -999; position: absolute;"\n        name="${this.name}"\n        value="${this.value}"\n      >`)}componentDidLoad(){if(this.checkValidity()&&this.state=="pending"){this.controller=new S(this.el);this.controller.dispatch("initialize",{controller:this.controller})}}checkValidity(){let t=[];t.push(...new q(this).errors);t.push(...new z(this).errors);this.inputTarget.setCustomValidity(t.join(" "));this.inputTarget.reportValidity();return t.length===0}static get watchers(){return{filename:["setMissingFiletype"]}}};Ct.style=$t;class Et extends HTMLElement{constructor(){super();this.handleDragOver=this.handleDragOver.bind(this);this.handleDragLeave=this.handleDragLeave.bind(this);this.handleDrop=this.handleDrop.bind(this)}static get observedAttributes(){return["for"]}connectedCallback(){this.addEventListener("dragover",this.handleDragOver);this.addEventListener("dragleave",this.handleDragLeave);this.addEventListener("drop",this.handleDrop);this.applyDefaultStyles()}disconnectedCallback(){this.removeEventListener("dragover",this.handleDragOver);this.removeEventListener("dragleave",this.handleDragLeave);this.removeEventListener("drop",this.handleDrop)}get fileTarget(){const t=this.getAttribute("for");if(!t)return null;return document.querySelector(`#${t}`)}handleDragOver(t){t.preventDefault();this.classList.add("-dragover")}handleDragLeave(){this.classList.remove("-dragover")}handleDrop(t){t.preventDefault();this.classList.remove("-dragover");const e=this.fileTarget;if(e&&t.dataTransfer.files.length>0){e.files=t.dataTransfer.files;const i=new Event("change",{bubbles:true});e.dispatchEvent(i)}}applyDefaultStyles(){if(!this.hasAttribute("data-no-default-styles")){const t=`\n        file-drop {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          box-sizing: border-box;\n          min-height: 60px;\n          outline-offset: -10px;\n          padding: 20px;\n          background: rgba(255, 255, 255, 0.25);\n          text-align: center;\n          transition: all 0.15s ease 0s;\n          outline: rgba(0, 0, 0, 0.25) dashed 2px;\n          font-size: 13px;\n        }\n\n        file-drop.-dragover {\n          background: rgba(0, 0, 0, 0.1);\n          outline-color: rgba(0, 0, 0, 0.5);\n        }\n      `;if(!document.querySelector("#file-drop-default-styles")){const e=document.createElement("style");e.id="file-drop-default-styles";e.textContent=t;document.head.appendChild(e)}}}}if(!customElements.get("file-drop")){customElements.define("file-drop",Et)}const At=":host{display:block;padding:25px;color:var(--bard-file-text-color, #000);font-size:13px}file-drop{cursor:pointer}:host *{box-sizing:border-box;position:relative}drag-and-drop{display:block;outline-offset:-10px;background:rgba(255,255,255, 0.25);margin:0;text-align:center;transition:all 0.15s;outline:2px dashed rgba(0,0,0,0.25);color:#444;font-size:14px}p{padding:10px 20px;margin:0}drag-and-drop.-full{width:100%}.-dragover{background:rgba(255,255,255,0.5);outline:2px dashed rgba(0,0,0,0.25)}.media-preview{display:flex;flex-wrap:wrap;align-items:flex-start;justify-content:center}// UPLOADER .direct-upload-wrapper{position:fixed;z-index:9999;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background:rgba(#333, 0.9)}.direct-upload-content{display:block;background:#fcfcfc;padding:40px 60px 60px;border-radius:3px;width:60vw}.direct-upload-content h3{border-bottom:2px solid #1f1f1f;margin-bottom:20px}.separate-upload{padding:0 10px;margin-top:10px;font-size:0.9em}.direct-upload--pending{opacity:0.6}.direct-upload--complete{opacity:0.4}.direct-upload--error{border-color:red}input[type=file][data-direct-upload-url][disabled]{display:none}:host.separate-upload{padding:0 10px;margin-top:10px;font-size:0.9em}";const Ut=class{get el(){return t(this)}name;directupload;multiple=false;required=false;accepts;max;preview=true;_forceUpdate=false;forceUpdate(){this._forceUpdate=!this._forceUpdate}form;fileTargetId;fileTarget;hiddenTargetId;hiddenTarget;_files=[];constructor(t){e(this,t);this.fileTargetId=this.el.id;this.fileTarget=yt(`<input id="${this.fileTargetId}">`);this.hiddenTargetId=`hidden-target-${this.el.getAttribute("name")}`;this.hiddenTarget=yt(`<input id="${this.hiddenTargetId}">`)}componentWillLoad(){this.el.removeAttribute("id");this.form=this.el.closest("form");this.form.addEventListener("reset",(()=>this.reset()));n.instance(this.form);const t=Array.from(this.el.children).filter((t=>t.tagName=="UPLOADED-FILE"));if(t.length>0)this.files=t}get files(){return this._files}set files(t){this._files=t;if(!this.multiple)this._files=this._files.slice(-1);this.forceUpdate();this.fireChangeEvent()}get value(){return this.files.map((t=>t.value))}set value(t){const e=t||[];if(JSON.stringify(this.value)!==JSON.stringify(e)){this.files=e.map((t=>Object.assign(new Ct,{name:this.name,preview:this.preview,signedId:t})))}}reset(){this.value=[]}fileTargetChanged(t){if(t.target!==this.fileTarget)return;this.files.push(...Array.from(this.fileTarget.files).map((t=>Object.assign(new Ct,{name:this.name,preview:this.preview,url:this.directupload,accepts:this.accepts,max:this.max,file:t}))));this.files=this.files;this.fileTarget.value=null}removeUploadedFile(t){xt(this.files,t.detail);this.files=this.files}fireChangeEvent(){requestAnimationFrame((()=>this.el.dispatchEvent(new Event("change",{bubbles:true}))))}render(){return s(r,{key:"ab3a5bae8e654113956ee0eb467443dcdb0adb1a"},s("file-drop",{key:"ae3c0de783a09f595ab64ac447908e11b4e2a712",for:this.fileTargetId,onClick:()=>this.fileTarget.click()},s("p",{key:"2d68ab77057e2cf0520d2da17f6b5185568baf33",part:"title"},s("strong",{key:"31718028c7aee521f3f79ad5d2b975ed9e9732ce"},"Choose ",this.multiple?"files":"file"," "),s("span",{key:"ef5d6e2aff3e4d460ce4319a14f33dceac9a836b"},"or drag ",this.multiple?"them":"it"," here.")),s("div",{key:"a03c162469b324f159934de66dbc813f16b4bbf6",class:`media-preview ${this.multiple?"-stacked":""}`},s("slot",{key:"7b03028a371dafa4513594134fc55a222ea6e6cc"}))))}componentDidRender(){wt(this.fileTarget,`\n      <input id="${this.fileTargetId}"\n        type="file"\n        ${this.multiple?"multiple":""}\n        ${this.required&&this.files.length===0?"required":""}\n        style="opacity: 0.01; width: 1px; height: 1px; z-index: -999"\n      >`);wt(this.hiddenTarget,`\n      <input id="${this.hiddenTargetId}"\n        type="hidden"\n        name="${this.name}"\n        ${this.files.length>0?"disabled":""}\n      >`);const t=document.createElement("div");while(t.firstChild){t.removeChild(t.firstChild)}t.appendChild(this.fileTarget);t.appendChild(this.hiddenTarget);this.files.forEach((e=>t.appendChild(e)));wt(this.el,t,{childrenOnly:true})}checkValidity(){return this.fileTarget.checkValidity()}setCustomValidity(t){this.fileTarget.setCustomValidity(t)}reportValidity(){this.fileTarget.reportValidity()}get validationMessage(){return this.fileTarget.validationMessage}};Ut.style=At;const Rt=":host{display:block;font-size:13px}img,video{max-width:100%;margin-top:10px}";const jt=class{constructor(t){e(this,t)}src;filetype;render(){return s(r,{key:"4ac011f2a5a1d7d9130f86014351513b9a42f843",class:this.computeClass()},this.isImage()&&s("img",{key:"7a169a7185eb1494a61a7b3c0f628f9a214bcb39",src:this.src}),this.isVideo()&&s("video",{key:"cd8b3414f65e19a24f8c2ccb55606c7b01fd31ff",src:this.src,onClick:Mt}),this.isOther()&&"This file does not offer a preview",s("slot",{key:"de543ee7457c0685666ed8acac67ba7d2e3631ed"}))}computeClass(){if(this.isImage())return"image";if(this.isVideo())return"video";return"other"}isImage(){return this.filetype=="image"}isVideo(){return this.filetype=="video"}isOther(){return!this.isImage()&&!this.isVideo()}};const Mt=function(){this.paused?this.play():this.pause();return false};jt.style=Rt;export{Ut as bard_file,jt as file_preview,Ct as uploaded_file};
//# sourceMappingURL=p-ce3ea203.entry.js.map