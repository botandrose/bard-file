{"version":3,"names":["FormController","instance","form","bardFileFormController","progressContainerTarget","dialog","element","progressTargetMap","controllers","submitted","processing","errors","constructor","this","insertAdjacentHTML","querySelector","dataset","remote","turbo","window","Turbo","session","enabled","addEventListener","event","submit","beforeUnload","init","start","progress","error","end","removeUploadedFile","preventDefault","returnValue","startNextController","showModal","controller","shift","Array","from","querySelectorAll","forEach","e","disabled","submitForm","setTimeout","id","file","detail","name","progressTarget","document","getElementById","push","classList","remove","percent","target","add","title","uploadedFile","directUpload","sparkMd5","exports","module","factory","undefined$1","hex_chr","md5cycle","x","k","a","b","c","d","md5blk","s","md5blks","i","charCodeAt","md5blk_array","md51","n","length","state","tail","tmp","lo","hi","substring","toString","match","parseInt","md51_array","subarray","Uint8Array","rhex","j","hex","join","ArrayBuffer","prototype","slice","clamp","val","Math","max","min","to","byteLength","begin","num","targetArray","sourceArray","set","toUtf8","str","test","unescape","encodeURIComponent","utf8Str2ArrayBuffer","returnUInt8Array","buff","arr","arrayBuffer2Utf8Str","String","fromCharCode","apply","concatenateArrayBuffers","first","second","result","buffer","hexToBinaryString","bytes","substr","SparkMD5","reset","append","appendBinary","contents","_buff","_length","_hash","raw","ret","_finish","getState","hash","setState","destroy","hashBinary","content","call","fileSlice","File","mozSlice","webkitSlice","FileChecksum","create","callback","chunkSize","chunkCount","ceil","size","chunkIndex","md5Buffer","fileReader","FileReader","fileReaderDidLoad","fileReaderDidError","readNextChunk","binaryDigest","base64digest","btoa","readAsArrayBuffer","getMetaValue","findElement","head","getAttribute","findElements","root","selector","elements","toArray","dispatchEvent","type","eventInit","bubbles","cancelable","createEvent","initEvent","value","isArray","BlobRecord","checksum","url","customHeaders","attributes","filename","content_type","byte_size","xhr","XMLHttpRequest","open","responseType","setRequestHeader","Object","keys","headerKey","csrfToken","undefined","requestDidLoad","requestDidError","status","response","JSON","parse","send","stringify","blob","direct_upload","directUploadData","toJSON","key","BlobUpload","headers","DirectUpload","delegate","notify","upload","object","methodName","messages","DirectUploadController","input","dispatch","hiddenInput","createElement","insertAdjacentElement","parentNode","removeChild","dispatchError","signed_id","uploadRequestDidProgress","loaded","total","defaultPrevented","alert","directUploadWillCreateBlobWithXHR","directUploadWillStoreFileWithXHR","inputSelector","DirectUploadsController","inputs","filter","files","createDirectUploadControllers","processingAttribute","submitButtonsByForm","WeakMap","started","didClick","didSubmitForm","didSubmitRemoteElement","tagName","handleFormSubmissionEvent","hasAttribute","setAttribute","disable","removeAttribute","enable","button","get","focus","click","style","display","appendChild","delete","autostart","ActiveStorage","recordXHR","uploadXHR","cancel","abortXHR","complete","abort","_attributes","Max","checkValidity","errorMessage","formatBytes","decimals","dm","sizes","floor","log","parseFloat","pow","toFixed","Accepts","accepts","split","includes","filetype","joinWords","words","at","Extensions","image","video","pdf","getFileType","normalized","toLowerCase","trim","FetchResponse","statusCode","redirected","ok","unauthenticated","unprocessableEntity","authenticationURL","contentType","replace","html","text","Promise","reject","Error","json","responseJson","responseText","isTurboStream","renderTurboStream","renderStreamMessage","console","warn","RequestInterceptor","register","interceptor","getCookie","cookies","cookie","prefix","find","startsWith","decodeURIComponent","compact","metaContent","stringEntriesFromFormData","formData","reduce","entries","concat","mergeEntries","searchParams","has","FetchRequest","method","options","originalUrl","perform","requestInterceptor","fetch","fetchOptions","location","href","addHeader","additionalHeaders","toUpperCase","body","formattedBody","signal","credentials","redirect","assign","Accept","accept","FormData","responseKind","query","originalQuery","params","URLSearchParams","requestQuery","bodyIsAString","contentTypeIsJson","request","verb","payload","req","then","DOCUMENT_FRAGMENT_NODE","morphAttrs","fromNode","toNode","toNodeAttrs","attr","attrName","attrNamespaceURI","attrValue","fromValue","nodeType","namespaceURI","localName","getAttributeNS","setAttributeNS","fromNodeAttrs","hasAttributeNS","removeAttributeNS","range","NS_XHTML","doc","HAS_TEMPLATE_SUPPORT","HAS_RANGE_SUPPORT","createRange","createFragmentFromTemplate","template","innerHTML","childNodes","createFragmentFromRange","selectNode","fragment","createContextualFragment","createFragmentFromWrap","toElement","compareNodeNames","fromEl","toEl","fromNodeName","nodeName","toNodeName","fromCodeStart","toCodeStart","createElementNS","moveChildren","curChild","firstChild","nextChild","nextSibling","syncBooleanAttrProp","specialElHandlers","OPTION","parentName","selected","selectedIndex","INPUT","TEXTAREA","newValue","oldValue","nodeValue","placeholder","SELECT","optgroup","ELEMENT_NODE","DOCUMENT_FRAGMENT_NODE$1","TEXT_NODE","COMMENT_NODE","noop","defaultGetNodeKey","node","morphdomFactory","morphdom","toNodeHtml","firstElementChild","getNodeKey","onBeforeNodeAdded","onNodeAdded","onBeforeElUpdated","onElUpdated","onBeforeNodeDiscarded","onNodeDiscarded","onBeforeElChildrenUpdated","skipFromChildren","addChild","parent","child","childrenOnly","fromNodesLookup","keyedRemovalList","addKeyedRemoval","walkDiscardedChildNodes","skipKeyedNodes","removeNode","indexTree","handleNodeAdded","el","unmatchedFromEl","replaceChild","morphEl","cleanupFromEl","curFromNodeChild","curFromNodeKey","fromNextSibling","toElKey","morphChildren","skipFrom","curToNodeChild","curToNodeKey","toNextSibling","matchingFromEl","outer","isSameNode","curFromNodeType","isCompatible","insertBefore","onBeforeNodeAddedResult","actualize","ownerDocument","specialElHandler","morphedNode","morphedNodeType","toNodeType","len","elToRemove","morph","children","arrayRemove","index","findIndex","splice","uploadedFileCss","uid","UploadedFile","removeEvent","removeClicked","stopPropagation","emit","inputTarget","_file","hostRef","componentWillLoad","setMissingFiletype","src","URL","createObjectURL","signedId","_value","_previousValue","_event","setCustomValidity","render","h","Host","class","download","onClick","preview","componentDidRender","componentDidLoad","reportValidity","FileDrop","HTMLElement","super","handleDragOver","bind","handleDragLeave","handleDrop","observedAttributes","connectedCallback","applyDefaultStyles","disconnectedCallback","removeEventListener","fileTarget","forValue","dataTransfer","changeEvent","Event","styles","styleElement","textContent","customElements","define","bardFileCss","BardFile","forceUpdate","_forceUpdate","fileTargetId","hiddenTargetId","hiddenTarget","_files","closest","existingFiles","multiple","fireChangeEvent","map","fileTargetChanged","directupload","requestAnimationFrame","for","part","required","wrapper","msg","validationMessage","filePreviewCss","FilePreview","computeClass","isImage","isVideo","toggle","isOther","paused","play","pause","progressBarCss","ProgressBar","width"],"sources":["src/components/bard-file/form-controller.tsx","node_modules/@rails/activestorage/app/assets/javascripts/activestorage.esm.js","src/components/uploaded-file/direct-upload-controller.tsx","src/components/uploaded-file/max.ts","src/components/uploaded-file/accepts.ts","src/components/uploaded-file/extensions.ts","node_modules/@rails/request.js/src/fetch_response.js","node_modules/@rails/request.js/src/request_interceptor.js","node_modules/@rails/request.js/src/lib/utils.js","node_modules/@rails/request.js/src/fetch_request.js","node_modules/rails-request-json/index.js","node_modules/morphdom/dist/morphdom-esm.js","src/utils/utils.ts","src/components/uploaded-file/uploaded-file.css?tag=uploaded-file&encapsulation=shadow","src/components/uploaded-file/uploaded-file.tsx","../file-drop/src/file-drop.js","src/components/bard-file/bard-file.css?tag=bard-file&encapsulation=shadow","src/components/bard-file/bard-file.tsx","src/components/file-preview/file-preview.css?tag=file-preview&encapsulation=shadow","src/components/file-preview/file-preview.tsx","src/components/progress-bar/progress-bar.css?tag=progress-bar&encapsulation=shadow","src/components/progress-bar/progress-bar.tsx"],"sourcesContent":["import DirectUploadController from \"../uploaded-file/direct-upload-controller\"\n\nexport default class FormController {\n  static instance(form) {\n    return form.bardFileFormController ||= new FormController(form)\n  }\n\n  progressContainerTarget: HTMLElement\n  dialog: HTMLDialogElement\n\n  element: HTMLFormElement\n  progressTargetMap: {}\n  controllers: Array<DirectUploadController>\n  submitted: boolean\n  processing: boolean\n  errors: boolean\n\n  constructor(form) {\n    this.element = form\n    this.progressTargetMap = {}\n    this.controllers = []\n    this.submitted = false\n    this.processing = false\n    this.errors = false\n\n    this.element.insertAdjacentHTML(\"beforeend\",\n      `<dialog id=\"form-controller-dialog\">\n        <div class=\"direct-upload-wrapper\">\n          <div class=\"direct-upload-content\">\n            <h3>Uploading your media</h3>\n            <div id=\"progress-container\"></div>\n          </div>\n        </div>\n      </dialog>`)\n\n    this.dialog = this.element.querySelector(\"#form-controller-dialog\")\n    this.progressContainerTarget = this.dialog.querySelector(\"#progress-container\")\n\n    if(this.element.dataset.remote !== \"true\" && (this.element.dataset.turbo == \"false\" || !(window as any).Turbo?.session?.enabled)) {\n      this.element.addEventListener(\"submit\", event => this.submit(event))\n    }\n    window.addEventListener(\"beforeunload\", event => this.beforeUnload(event))\n\n    this.element.addEventListener(\"direct-upload:initialize\", event => this.init(event))\n    this.element.addEventListener(\"direct-upload:start\", event => this.start(event))\n    this.element.addEventListener(\"direct-upload:progress\", event => this.progress(event))\n    this.element.addEventListener(\"direct-upload:error\", event => this.error(event))\n    this.element.addEventListener(\"direct-upload:end\", event => this.end(event))\n\n    this.element.addEventListener(\"uploaded-file:remove\", event => this.removeUploadedFile(event))\n  }\n\n  beforeUnload(event) {\n    if(this.processing) {\n      event.preventDefault()\n      return (event.returnValue = \"\")\n    }\n  }\n\n  submit(event) {\n    event.preventDefault()\n    this.submitted = true\n    this.startNextController()\n    if(this.processing) {\n      this.dialog.showModal()\n    }\n  }\n\n  startNextController() {\n    if(this.processing) return\n\n    const controller = this.controllers.shift()\n    if(controller) {\n      this.processing = true\n      controller.start(error => {\n        if(error) {\n          Array.from(this.element.querySelectorAll(\"input[type=file]\"))\n            .forEach((e: HTMLInputElement) => e.disabled = false)\n        }\n        this.processing = false\n        this.startNextController()\n      })\n    } else {\n      this.submitForm()\n    }\n  }\n\n  submitForm() {\n    if(this.submitted) {\n      Array.from(this.element.querySelectorAll(\"input[type=file]\"))\n        .forEach((e: HTMLInputElement) => e.disabled = true)\n      window.setTimeout(() => { // allow other async tasks to complete\n        this.element.submit()\n      }, 10)\n    }\n  }\n\n  init(event) {\n    const { id, file, controller } = event.detail\n\n    this.progressContainerTarget.insertAdjacentHTML(\"beforebegin\", `\n      <progress-bar id=\"direct-upload-${id}\" class=\"direct-upload--pending\">${file.name}</progress-bar>\n    `)\n    const progressTarget = document.getElementById(`direct-upload-${id}`)\n    this.progressTargetMap[id] = progressTarget\n\n    this.controllers.push(controller)\n    this.startNextController()\n  }\n\n  start(event) {\n    this.progressTargetMap[event.detail.id].classList.remove(\"direct-upload--pending\")\n  }\n\n  progress(event) {\n    const { id, progress } = event.detail\n    this.progressTargetMap[id].percent = progress\n  }\n\n  error(event) {\n    event.preventDefault()\n    const { id, error } = event.detail\n    const target = this.progressTargetMap[id]\n    target.classList.add(\"direct-upload--error\")\n    target.title = error\n  }\n\n  end(event) {\n    this.progressTargetMap[event.detail.id].classList.add(\"direct-upload--complete\")\n  }\n\n  removeUploadedFile(event) {\n    const uploadedFile = event.detail\n    const id = uploadedFile.controller?.directUpload?.id\n    if(id) {\n      document.getElementById(`direct-upload-${id}`).remove()\n      delete this.progressTargetMap[id]\n    }\n  }\n}\n\n\n","var sparkMd5 = {\n  exports: {}\n};\n\n(function(module, exports) {\n  (function(factory) {\n    {\n      module.exports = factory();\n    }\n  })((function(undefined$1) {\n    var hex_chr = [ \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\" ];\n    function md5cycle(x, k) {\n      var a = x[0], b = x[1], c = x[2], d = x[3];\n      a += (b & c | ~b & d) + k[0] - 680876936 | 0;\n      a = (a << 7 | a >>> 25) + b | 0;\n      d += (a & b | ~a & c) + k[1] - 389564586 | 0;\n      d = (d << 12 | d >>> 20) + a | 0;\n      c += (d & a | ~d & b) + k[2] + 606105819 | 0;\n      c = (c << 17 | c >>> 15) + d | 0;\n      b += (c & d | ~c & a) + k[3] - 1044525330 | 0;\n      b = (b << 22 | b >>> 10) + c | 0;\n      a += (b & c | ~b & d) + k[4] - 176418897 | 0;\n      a = (a << 7 | a >>> 25) + b | 0;\n      d += (a & b | ~a & c) + k[5] + 1200080426 | 0;\n      d = (d << 12 | d >>> 20) + a | 0;\n      c += (d & a | ~d & b) + k[6] - 1473231341 | 0;\n      c = (c << 17 | c >>> 15) + d | 0;\n      b += (c & d | ~c & a) + k[7] - 45705983 | 0;\n      b = (b << 22 | b >>> 10) + c | 0;\n      a += (b & c | ~b & d) + k[8] + 1770035416 | 0;\n      a = (a << 7 | a >>> 25) + b | 0;\n      d += (a & b | ~a & c) + k[9] - 1958414417 | 0;\n      d = (d << 12 | d >>> 20) + a | 0;\n      c += (d & a | ~d & b) + k[10] - 42063 | 0;\n      c = (c << 17 | c >>> 15) + d | 0;\n      b += (c & d | ~c & a) + k[11] - 1990404162 | 0;\n      b = (b << 22 | b >>> 10) + c | 0;\n      a += (b & c | ~b & d) + k[12] + 1804603682 | 0;\n      a = (a << 7 | a >>> 25) + b | 0;\n      d += (a & b | ~a & c) + k[13] - 40341101 | 0;\n      d = (d << 12 | d >>> 20) + a | 0;\n      c += (d & a | ~d & b) + k[14] - 1502002290 | 0;\n      c = (c << 17 | c >>> 15) + d | 0;\n      b += (c & d | ~c & a) + k[15] + 1236535329 | 0;\n      b = (b << 22 | b >>> 10) + c | 0;\n      a += (b & d | c & ~d) + k[1] - 165796510 | 0;\n      a = (a << 5 | a >>> 27) + b | 0;\n      d += (a & c | b & ~c) + k[6] - 1069501632 | 0;\n      d = (d << 9 | d >>> 23) + a | 0;\n      c += (d & b | a & ~b) + k[11] + 643717713 | 0;\n      c = (c << 14 | c >>> 18) + d | 0;\n      b += (c & a | d & ~a) + k[0] - 373897302 | 0;\n      b = (b << 20 | b >>> 12) + c | 0;\n      a += (b & d | c & ~d) + k[5] - 701558691 | 0;\n      a = (a << 5 | a >>> 27) + b | 0;\n      d += (a & c | b & ~c) + k[10] + 38016083 | 0;\n      d = (d << 9 | d >>> 23) + a | 0;\n      c += (d & b | a & ~b) + k[15] - 660478335 | 0;\n      c = (c << 14 | c >>> 18) + d | 0;\n      b += (c & a | d & ~a) + k[4] - 405537848 | 0;\n      b = (b << 20 | b >>> 12) + c | 0;\n      a += (b & d | c & ~d) + k[9] + 568446438 | 0;\n      a = (a << 5 | a >>> 27) + b | 0;\n      d += (a & c | b & ~c) + k[14] - 1019803690 | 0;\n      d = (d << 9 | d >>> 23) + a | 0;\n      c += (d & b | a & ~b) + k[3] - 187363961 | 0;\n      c = (c << 14 | c >>> 18) + d | 0;\n      b += (c & a | d & ~a) + k[8] + 1163531501 | 0;\n      b = (b << 20 | b >>> 12) + c | 0;\n      a += (b & d | c & ~d) + k[13] - 1444681467 | 0;\n      a = (a << 5 | a >>> 27) + b | 0;\n      d += (a & c | b & ~c) + k[2] - 51403784 | 0;\n      d = (d << 9 | d >>> 23) + a | 0;\n      c += (d & b | a & ~b) + k[7] + 1735328473 | 0;\n      c = (c << 14 | c >>> 18) + d | 0;\n      b += (c & a | d & ~a) + k[12] - 1926607734 | 0;\n      b = (b << 20 | b >>> 12) + c | 0;\n      a += (b ^ c ^ d) + k[5] - 378558 | 0;\n      a = (a << 4 | a >>> 28) + b | 0;\n      d += (a ^ b ^ c) + k[8] - 2022574463 | 0;\n      d = (d << 11 | d >>> 21) + a | 0;\n      c += (d ^ a ^ b) + k[11] + 1839030562 | 0;\n      c = (c << 16 | c >>> 16) + d | 0;\n      b += (c ^ d ^ a) + k[14] - 35309556 | 0;\n      b = (b << 23 | b >>> 9) + c | 0;\n      a += (b ^ c ^ d) + k[1] - 1530992060 | 0;\n      a = (a << 4 | a >>> 28) + b | 0;\n      d += (a ^ b ^ c) + k[4] + 1272893353 | 0;\n      d = (d << 11 | d >>> 21) + a | 0;\n      c += (d ^ a ^ b) + k[7] - 155497632 | 0;\n      c = (c << 16 | c >>> 16) + d | 0;\n      b += (c ^ d ^ a) + k[10] - 1094730640 | 0;\n      b = (b << 23 | b >>> 9) + c | 0;\n      a += (b ^ c ^ d) + k[13] + 681279174 | 0;\n      a = (a << 4 | a >>> 28) + b | 0;\n      d += (a ^ b ^ c) + k[0] - 358537222 | 0;\n      d = (d << 11 | d >>> 21) + a | 0;\n      c += (d ^ a ^ b) + k[3] - 722521979 | 0;\n      c = (c << 16 | c >>> 16) + d | 0;\n      b += (c ^ d ^ a) + k[6] + 76029189 | 0;\n      b = (b << 23 | b >>> 9) + c | 0;\n      a += (b ^ c ^ d) + k[9] - 640364487 | 0;\n      a = (a << 4 | a >>> 28) + b | 0;\n      d += (a ^ b ^ c) + k[12] - 421815835 | 0;\n      d = (d << 11 | d >>> 21) + a | 0;\n      c += (d ^ a ^ b) + k[15] + 530742520 | 0;\n      c = (c << 16 | c >>> 16) + d | 0;\n      b += (c ^ d ^ a) + k[2] - 995338651 | 0;\n      b = (b << 23 | b >>> 9) + c | 0;\n      a += (c ^ (b | ~d)) + k[0] - 198630844 | 0;\n      a = (a << 6 | a >>> 26) + b | 0;\n      d += (b ^ (a | ~c)) + k[7] + 1126891415 | 0;\n      d = (d << 10 | d >>> 22) + a | 0;\n      c += (a ^ (d | ~b)) + k[14] - 1416354905 | 0;\n      c = (c << 15 | c >>> 17) + d | 0;\n      b += (d ^ (c | ~a)) + k[5] - 57434055 | 0;\n      b = (b << 21 | b >>> 11) + c | 0;\n      a += (c ^ (b | ~d)) + k[12] + 1700485571 | 0;\n      a = (a << 6 | a >>> 26) + b | 0;\n      d += (b ^ (a | ~c)) + k[3] - 1894986606 | 0;\n      d = (d << 10 | d >>> 22) + a | 0;\n      c += (a ^ (d | ~b)) + k[10] - 1051523 | 0;\n      c = (c << 15 | c >>> 17) + d | 0;\n      b += (d ^ (c | ~a)) + k[1] - 2054922799 | 0;\n      b = (b << 21 | b >>> 11) + c | 0;\n      a += (c ^ (b | ~d)) + k[8] + 1873313359 | 0;\n      a = (a << 6 | a >>> 26) + b | 0;\n      d += (b ^ (a | ~c)) + k[15] - 30611744 | 0;\n      d = (d << 10 | d >>> 22) + a | 0;\n      c += (a ^ (d | ~b)) + k[6] - 1560198380 | 0;\n      c = (c << 15 | c >>> 17) + d | 0;\n      b += (d ^ (c | ~a)) + k[13] + 1309151649 | 0;\n      b = (b << 21 | b >>> 11) + c | 0;\n      a += (c ^ (b | ~d)) + k[4] - 145523070 | 0;\n      a = (a << 6 | a >>> 26) + b | 0;\n      d += (b ^ (a | ~c)) + k[11] - 1120210379 | 0;\n      d = (d << 10 | d >>> 22) + a | 0;\n      c += (a ^ (d | ~b)) + k[2] + 718787259 | 0;\n      c = (c << 15 | c >>> 17) + d | 0;\n      b += (d ^ (c | ~a)) + k[9] - 343485551 | 0;\n      b = (b << 21 | b >>> 11) + c | 0;\n      x[0] = a + x[0] | 0;\n      x[1] = b + x[1] | 0;\n      x[2] = c + x[2] | 0;\n      x[3] = d + x[3] | 0;\n    }\n    function md5blk(s) {\n      var md5blks = [], i;\n      for (i = 0; i < 64; i += 4) {\n        md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n      }\n      return md5blks;\n    }\n    function md5blk_array(a) {\n      var md5blks = [], i;\n      for (i = 0; i < 64; i += 4) {\n        md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n      }\n      return md5blks;\n    }\n    function md51(s) {\n      var n = s.length, state = [ 1732584193, -271733879, -1732584194, 271733878 ], i, length, tail, tmp, lo, hi;\n      for (i = 64; i <= n; i += 64) {\n        md5cycle(state, md5blk(s.substring(i - 64, i)));\n      }\n      s = s.substring(i - 64);\n      length = s.length;\n      tail = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n      for (i = 0; i < length; i += 1) {\n        tail[i >> 2] |= s.charCodeAt(i) << (i % 4 << 3);\n      }\n      tail[i >> 2] |= 128 << (i % 4 << 3);\n      if (i > 55) {\n        md5cycle(state, tail);\n        for (i = 0; i < 16; i += 1) {\n          tail[i] = 0;\n        }\n      }\n      tmp = n * 8;\n      tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n      lo = parseInt(tmp[2], 16);\n      hi = parseInt(tmp[1], 16) || 0;\n      tail[14] = lo;\n      tail[15] = hi;\n      md5cycle(state, tail);\n      return state;\n    }\n    function md51_array(a) {\n      var n = a.length, state = [ 1732584193, -271733879, -1732584194, 271733878 ], i, length, tail, tmp, lo, hi;\n      for (i = 64; i <= n; i += 64) {\n        md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n      }\n      a = i - 64 < n ? a.subarray(i - 64) : new Uint8Array(0);\n      length = a.length;\n      tail = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n      for (i = 0; i < length; i += 1) {\n        tail[i >> 2] |= a[i] << (i % 4 << 3);\n      }\n      tail[i >> 2] |= 128 << (i % 4 << 3);\n      if (i > 55) {\n        md5cycle(state, tail);\n        for (i = 0; i < 16; i += 1) {\n          tail[i] = 0;\n        }\n      }\n      tmp = n * 8;\n      tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n      lo = parseInt(tmp[2], 16);\n      hi = parseInt(tmp[1], 16) || 0;\n      tail[14] = lo;\n      tail[15] = hi;\n      md5cycle(state, tail);\n      return state;\n    }\n    function rhex(n) {\n      var s = \"\", j;\n      for (j = 0; j < 4; j += 1) {\n        s += hex_chr[n >> j * 8 + 4 & 15] + hex_chr[n >> j * 8 & 15];\n      }\n      return s;\n    }\n    function hex(x) {\n      var i;\n      for (i = 0; i < x.length; i += 1) {\n        x[i] = rhex(x[i]);\n      }\n      return x.join(\"\");\n    }\n    if (hex(md51(\"hello\")) !== \"5d41402abc4b2a76b9719d911017c592\") ;\n    if (typeof ArrayBuffer !== \"undefined\" && !ArrayBuffer.prototype.slice) {\n      (function() {\n        function clamp(val, length) {\n          val = val | 0 || 0;\n          if (val < 0) {\n            return Math.max(val + length, 0);\n          }\n          return Math.min(val, length);\n        }\n        ArrayBuffer.prototype.slice = function(from, to) {\n          var length = this.byteLength, begin = clamp(from, length), end = length, num, target, targetArray, sourceArray;\n          if (to !== undefined$1) {\n            end = clamp(to, length);\n          }\n          if (begin > end) {\n            return new ArrayBuffer(0);\n          }\n          num = end - begin;\n          target = new ArrayBuffer(num);\n          targetArray = new Uint8Array(target);\n          sourceArray = new Uint8Array(this, begin, num);\n          targetArray.set(sourceArray);\n          return target;\n        };\n      })();\n    }\n    function toUtf8(str) {\n      if (/[\\u0080-\\uFFFF]/.test(str)) {\n        str = unescape(encodeURIComponent(str));\n      }\n      return str;\n    }\n    function utf8Str2ArrayBuffer(str, returnUInt8Array) {\n      var length = str.length, buff = new ArrayBuffer(length), arr = new Uint8Array(buff), i;\n      for (i = 0; i < length; i += 1) {\n        arr[i] = str.charCodeAt(i);\n      }\n      return returnUInt8Array ? arr : buff;\n    }\n    function arrayBuffer2Utf8Str(buff) {\n      return String.fromCharCode.apply(null, new Uint8Array(buff));\n    }\n    function concatenateArrayBuffers(first, second, returnUInt8Array) {\n      var result = new Uint8Array(first.byteLength + second.byteLength);\n      result.set(new Uint8Array(first));\n      result.set(new Uint8Array(second), first.byteLength);\n      return returnUInt8Array ? result : result.buffer;\n    }\n    function hexToBinaryString(hex) {\n      var bytes = [], length = hex.length, x;\n      for (x = 0; x < length - 1; x += 2) {\n        bytes.push(parseInt(hex.substr(x, 2), 16));\n      }\n      return String.fromCharCode.apply(String, bytes);\n    }\n    function SparkMD5() {\n      this.reset();\n    }\n    SparkMD5.prototype.append = function(str) {\n      this.appendBinary(toUtf8(str));\n      return this;\n    };\n    SparkMD5.prototype.appendBinary = function(contents) {\n      this._buff += contents;\n      this._length += contents.length;\n      var length = this._buff.length, i;\n      for (i = 64; i <= length; i += 64) {\n        md5cycle(this._hash, md5blk(this._buff.substring(i - 64, i)));\n      }\n      this._buff = this._buff.substring(i - 64);\n      return this;\n    };\n    SparkMD5.prototype.end = function(raw) {\n      var buff = this._buff, length = buff.length, i, tail = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], ret;\n      for (i = 0; i < length; i += 1) {\n        tail[i >> 2] |= buff.charCodeAt(i) << (i % 4 << 3);\n      }\n      this._finish(tail, length);\n      ret = hex(this._hash);\n      if (raw) {\n        ret = hexToBinaryString(ret);\n      }\n      this.reset();\n      return ret;\n    };\n    SparkMD5.prototype.reset = function() {\n      this._buff = \"\";\n      this._length = 0;\n      this._hash = [ 1732584193, -271733879, -1732584194, 271733878 ];\n      return this;\n    };\n    SparkMD5.prototype.getState = function() {\n      return {\n        buff: this._buff,\n        length: this._length,\n        hash: this._hash.slice()\n      };\n    };\n    SparkMD5.prototype.setState = function(state) {\n      this._buff = state.buff;\n      this._length = state.length;\n      this._hash = state.hash;\n      return this;\n    };\n    SparkMD5.prototype.destroy = function() {\n      delete this._hash;\n      delete this._buff;\n      delete this._length;\n    };\n    SparkMD5.prototype._finish = function(tail, length) {\n      var i = length, tmp, lo, hi;\n      tail[i >> 2] |= 128 << (i % 4 << 3);\n      if (i > 55) {\n        md5cycle(this._hash, tail);\n        for (i = 0; i < 16; i += 1) {\n          tail[i] = 0;\n        }\n      }\n      tmp = this._length * 8;\n      tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n      lo = parseInt(tmp[2], 16);\n      hi = parseInt(tmp[1], 16) || 0;\n      tail[14] = lo;\n      tail[15] = hi;\n      md5cycle(this._hash, tail);\n    };\n    SparkMD5.hash = function(str, raw) {\n      return SparkMD5.hashBinary(toUtf8(str), raw);\n    };\n    SparkMD5.hashBinary = function(content, raw) {\n      var hash = md51(content), ret = hex(hash);\n      return raw ? hexToBinaryString(ret) : ret;\n    };\n    SparkMD5.ArrayBuffer = function() {\n      this.reset();\n    };\n    SparkMD5.ArrayBuffer.prototype.append = function(arr) {\n      var buff = concatenateArrayBuffers(this._buff.buffer, arr, true), length = buff.length, i;\n      this._length += arr.byteLength;\n      for (i = 64; i <= length; i += 64) {\n        md5cycle(this._hash, md5blk_array(buff.subarray(i - 64, i)));\n      }\n      this._buff = i - 64 < length ? new Uint8Array(buff.buffer.slice(i - 64)) : new Uint8Array(0);\n      return this;\n    };\n    SparkMD5.ArrayBuffer.prototype.end = function(raw) {\n      var buff = this._buff, length = buff.length, tail = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], i, ret;\n      for (i = 0; i < length; i += 1) {\n        tail[i >> 2] |= buff[i] << (i % 4 << 3);\n      }\n      this._finish(tail, length);\n      ret = hex(this._hash);\n      if (raw) {\n        ret = hexToBinaryString(ret);\n      }\n      this.reset();\n      return ret;\n    };\n    SparkMD5.ArrayBuffer.prototype.reset = function() {\n      this._buff = new Uint8Array(0);\n      this._length = 0;\n      this._hash = [ 1732584193, -271733879, -1732584194, 271733878 ];\n      return this;\n    };\n    SparkMD5.ArrayBuffer.prototype.getState = function() {\n      var state = SparkMD5.prototype.getState.call(this);\n      state.buff = arrayBuffer2Utf8Str(state.buff);\n      return state;\n    };\n    SparkMD5.ArrayBuffer.prototype.setState = function(state) {\n      state.buff = utf8Str2ArrayBuffer(state.buff, true);\n      return SparkMD5.prototype.setState.call(this, state);\n    };\n    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n    SparkMD5.ArrayBuffer.hash = function(arr, raw) {\n      var hash = md51_array(new Uint8Array(arr)), ret = hex(hash);\n      return raw ? hexToBinaryString(ret) : ret;\n    };\n    return SparkMD5;\n  }));\n})(sparkMd5);\n\nvar SparkMD5 = sparkMd5.exports;\n\nconst fileSlice = File.prototype.slice || File.prototype.mozSlice || File.prototype.webkitSlice;\n\nclass FileChecksum {\n  static create(file, callback) {\n    const instance = new FileChecksum(file);\n    instance.create(callback);\n  }\n  constructor(file) {\n    this.file = file;\n    this.chunkSize = 2097152;\n    this.chunkCount = Math.ceil(this.file.size / this.chunkSize);\n    this.chunkIndex = 0;\n  }\n  create(callback) {\n    this.callback = callback;\n    this.md5Buffer = new SparkMD5.ArrayBuffer;\n    this.fileReader = new FileReader;\n    this.fileReader.addEventListener(\"load\", (event => this.fileReaderDidLoad(event)));\n    this.fileReader.addEventListener(\"error\", (event => this.fileReaderDidError(event)));\n    this.readNextChunk();\n  }\n  fileReaderDidLoad(event) {\n    this.md5Buffer.append(event.target.result);\n    if (!this.readNextChunk()) {\n      const binaryDigest = this.md5Buffer.end(true);\n      const base64digest = btoa(binaryDigest);\n      this.callback(null, base64digest);\n    }\n  }\n  fileReaderDidError(event) {\n    this.callback(`Error reading ${this.file.name}`);\n  }\n  readNextChunk() {\n    if (this.chunkIndex < this.chunkCount || this.chunkIndex == 0 && this.chunkCount == 0) {\n      const start = this.chunkIndex * this.chunkSize;\n      const end = Math.min(start + this.chunkSize, this.file.size);\n      const bytes = fileSlice.call(this.file, start, end);\n      this.fileReader.readAsArrayBuffer(bytes);\n      this.chunkIndex++;\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nfunction getMetaValue(name) {\n  const element = findElement(document.head, `meta[name=\"${name}\"]`);\n  if (element) {\n    return element.getAttribute(\"content\");\n  }\n}\n\nfunction findElements(root, selector) {\n  if (typeof root == \"string\") {\n    selector = root;\n    root = document;\n  }\n  const elements = root.querySelectorAll(selector);\n  return toArray(elements);\n}\n\nfunction findElement(root, selector) {\n  if (typeof root == \"string\") {\n    selector = root;\n    root = document;\n  }\n  return root.querySelector(selector);\n}\n\nfunction dispatchEvent(element, type, eventInit = {}) {\n  const {disabled: disabled} = element;\n  const {bubbles: bubbles, cancelable: cancelable, detail: detail} = eventInit;\n  const event = document.createEvent(\"Event\");\n  event.initEvent(type, bubbles || true, cancelable || true);\n  event.detail = detail || {};\n  try {\n    element.disabled = false;\n    element.dispatchEvent(event);\n  } finally {\n    element.disabled = disabled;\n  }\n  return event;\n}\n\nfunction toArray(value) {\n  if (Array.isArray(value)) {\n    return value;\n  } else if (Array.from) {\n    return Array.from(value);\n  } else {\n    return [].slice.call(value);\n  }\n}\n\nclass BlobRecord {\n  constructor(file, checksum, url, customHeaders = {}) {\n    this.file = file;\n    this.attributes = {\n      filename: file.name,\n      content_type: file.type || \"application/octet-stream\",\n      byte_size: file.size,\n      checksum: checksum\n    };\n    this.xhr = new XMLHttpRequest;\n    this.xhr.open(\"POST\", url, true);\n    this.xhr.responseType = \"json\";\n    this.xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n    this.xhr.setRequestHeader(\"Accept\", \"application/json\");\n    this.xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n    Object.keys(customHeaders).forEach((headerKey => {\n      this.xhr.setRequestHeader(headerKey, customHeaders[headerKey]);\n    }));\n    const csrfToken = getMetaValue(\"csrf-token\");\n    if (csrfToken != undefined) {\n      this.xhr.setRequestHeader(\"X-CSRF-Token\", csrfToken);\n    }\n    this.xhr.addEventListener(\"load\", (event => this.requestDidLoad(event)));\n    this.xhr.addEventListener(\"error\", (event => this.requestDidError(event)));\n  }\n  get status() {\n    return this.xhr.status;\n  }\n  get response() {\n    const {responseType: responseType, response: response} = this.xhr;\n    if (responseType == \"json\") {\n      return response;\n    } else {\n      return JSON.parse(response);\n    }\n  }\n  create(callback) {\n    this.callback = callback;\n    this.xhr.send(JSON.stringify({\n      blob: this.attributes\n    }));\n  }\n  requestDidLoad(event) {\n    if (this.status >= 200 && this.status < 300) {\n      const {response: response} = this;\n      const {direct_upload: direct_upload} = response;\n      delete response.direct_upload;\n      this.attributes = response;\n      this.directUploadData = direct_upload;\n      this.callback(null, this.toJSON());\n    } else {\n      this.requestDidError(event);\n    }\n  }\n  requestDidError(event) {\n    this.callback(`Error creating Blob for \"${this.file.name}\". Status: ${this.status}`);\n  }\n  toJSON() {\n    const result = {};\n    for (const key in this.attributes) {\n      result[key] = this.attributes[key];\n    }\n    return result;\n  }\n}\n\nclass BlobUpload {\n  constructor(blob) {\n    this.blob = blob;\n    this.file = blob.file;\n    const {url: url, headers: headers} = blob.directUploadData;\n    this.xhr = new XMLHttpRequest;\n    this.xhr.open(\"PUT\", url, true);\n    this.xhr.responseType = \"text\";\n    for (const key in headers) {\n      this.xhr.setRequestHeader(key, headers[key]);\n    }\n    this.xhr.addEventListener(\"load\", (event => this.requestDidLoad(event)));\n    this.xhr.addEventListener(\"error\", (event => this.requestDidError(event)));\n  }\n  create(callback) {\n    this.callback = callback;\n    this.xhr.send(this.file.slice());\n  }\n  requestDidLoad(event) {\n    const {status: status, response: response} = this.xhr;\n    if (status >= 200 && status < 300) {\n      this.callback(null, response);\n    } else {\n      this.requestDidError(event);\n    }\n  }\n  requestDidError(event) {\n    this.callback(`Error storing \"${this.file.name}\". Status: ${this.xhr.status}`);\n  }\n}\n\nlet id = 0;\n\nclass DirectUpload {\n  constructor(file, url, delegate, customHeaders = {}) {\n    this.id = ++id;\n    this.file = file;\n    this.url = url;\n    this.delegate = delegate;\n    this.customHeaders = customHeaders;\n  }\n  create(callback) {\n    FileChecksum.create(this.file, ((error, checksum) => {\n      if (error) {\n        callback(error);\n        return;\n      }\n      const blob = new BlobRecord(this.file, checksum, this.url, this.customHeaders);\n      notify(this.delegate, \"directUploadWillCreateBlobWithXHR\", blob.xhr);\n      blob.create((error => {\n        if (error) {\n          callback(error);\n        } else {\n          const upload = new BlobUpload(blob);\n          notify(this.delegate, \"directUploadWillStoreFileWithXHR\", upload.xhr);\n          upload.create((error => {\n            if (error) {\n              callback(error);\n            } else {\n              callback(null, blob.toJSON());\n            }\n          }));\n        }\n      }));\n    }));\n  }\n}\n\nfunction notify(object, methodName, ...messages) {\n  if (object && typeof object[methodName] == \"function\") {\n    return object[methodName](...messages);\n  }\n}\n\nclass DirectUploadController {\n  constructor(input, file) {\n    this.input = input;\n    this.file = file;\n    this.directUpload = new DirectUpload(this.file, this.url, this);\n    this.dispatch(\"initialize\");\n  }\n  start(callback) {\n    const hiddenInput = document.createElement(\"input\");\n    hiddenInput.type = \"hidden\";\n    hiddenInput.name = this.input.name;\n    this.input.insertAdjacentElement(\"beforebegin\", hiddenInput);\n    this.dispatch(\"start\");\n    this.directUpload.create(((error, attributes) => {\n      if (error) {\n        hiddenInput.parentNode.removeChild(hiddenInput);\n        this.dispatchError(error);\n      } else {\n        hiddenInput.value = attributes.signed_id;\n      }\n      this.dispatch(\"end\");\n      callback(error);\n    }));\n  }\n  uploadRequestDidProgress(event) {\n    const progress = event.loaded / event.total * 100;\n    if (progress) {\n      this.dispatch(\"progress\", {\n        progress: progress\n      });\n    }\n  }\n  get url() {\n    return this.input.getAttribute(\"data-direct-upload-url\");\n  }\n  dispatch(name, detail = {}) {\n    detail.file = this.file;\n    detail.id = this.directUpload.id;\n    return dispatchEvent(this.input, `direct-upload:${name}`, {\n      detail: detail\n    });\n  }\n  dispatchError(error) {\n    const event = this.dispatch(\"error\", {\n      error: error\n    });\n    if (!event.defaultPrevented) {\n      alert(error);\n    }\n  }\n  directUploadWillCreateBlobWithXHR(xhr) {\n    this.dispatch(\"before-blob-request\", {\n      xhr: xhr\n    });\n  }\n  directUploadWillStoreFileWithXHR(xhr) {\n    this.dispatch(\"before-storage-request\", {\n      xhr: xhr\n    });\n    xhr.upload.addEventListener(\"progress\", (event => this.uploadRequestDidProgress(event)));\n  }\n}\n\nconst inputSelector = \"input[type=file][data-direct-upload-url]:not([disabled])\";\n\nclass DirectUploadsController {\n  constructor(form) {\n    this.form = form;\n    this.inputs = findElements(form, inputSelector).filter((input => input.files.length));\n  }\n  start(callback) {\n    const controllers = this.createDirectUploadControllers();\n    const startNextController = () => {\n      const controller = controllers.shift();\n      if (controller) {\n        controller.start((error => {\n          if (error) {\n            callback(error);\n            this.dispatch(\"end\");\n          } else {\n            startNextController();\n          }\n        }));\n      } else {\n        callback();\n        this.dispatch(\"end\");\n      }\n    };\n    this.dispatch(\"start\");\n    startNextController();\n  }\n  createDirectUploadControllers() {\n    const controllers = [];\n    this.inputs.forEach((input => {\n      toArray(input.files).forEach((file => {\n        const controller = new DirectUploadController(input, file);\n        controllers.push(controller);\n      }));\n    }));\n    return controllers;\n  }\n  dispatch(name, detail = {}) {\n    return dispatchEvent(this.form, `direct-uploads:${name}`, {\n      detail: detail\n    });\n  }\n}\n\nconst processingAttribute = \"data-direct-uploads-processing\";\n\nconst submitButtonsByForm = new WeakMap;\n\nlet started = false;\n\nfunction start() {\n  if (!started) {\n    started = true;\n    document.addEventListener(\"click\", didClick, true);\n    document.addEventListener(\"submit\", didSubmitForm, true);\n    document.addEventListener(\"ajax:before\", didSubmitRemoteElement);\n  }\n}\n\nfunction didClick(event) {\n  const {target: target} = event;\n  if ((target.tagName == \"INPUT\" || target.tagName == \"BUTTON\") && target.type == \"submit\" && target.form) {\n    submitButtonsByForm.set(target.form, target);\n  }\n}\n\nfunction didSubmitForm(event) {\n  handleFormSubmissionEvent(event);\n}\n\nfunction didSubmitRemoteElement(event) {\n  if (event.target.tagName == \"FORM\") {\n    handleFormSubmissionEvent(event);\n  }\n}\n\nfunction handleFormSubmissionEvent(event) {\n  const form = event.target;\n  if (form.hasAttribute(processingAttribute)) {\n    event.preventDefault();\n    return;\n  }\n  const controller = new DirectUploadsController(form);\n  const {inputs: inputs} = controller;\n  if (inputs.length) {\n    event.preventDefault();\n    form.setAttribute(processingAttribute, \"\");\n    inputs.forEach(disable);\n    controller.start((error => {\n      form.removeAttribute(processingAttribute);\n      if (error) {\n        inputs.forEach(enable);\n      } else {\n        submitForm(form);\n      }\n    }));\n  }\n}\n\nfunction submitForm(form) {\n  let button = submitButtonsByForm.get(form) || findElement(form, \"input[type=submit], button[type=submit]\");\n  if (button) {\n    const {disabled: disabled} = button;\n    button.disabled = false;\n    button.focus();\n    button.click();\n    button.disabled = disabled;\n  } else {\n    button = document.createElement(\"input\");\n    button.type = \"submit\";\n    button.style.display = \"none\";\n    form.appendChild(button);\n    button.click();\n    form.removeChild(button);\n  }\n  submitButtonsByForm.delete(form);\n}\n\nfunction disable(input) {\n  input.disabled = true;\n}\n\nfunction enable(input) {\n  input.disabled = false;\n}\n\nfunction autostart() {\n  if (window.ActiveStorage) {\n    start();\n  }\n}\n\nsetTimeout(autostart, 1);\n\nexport { DirectUpload, DirectUploadController, DirectUploadsController, start };\n","import { DirectUpload } from \"@rails/activestorage\"\nimport { UploadedFile } from \"./uploaded-file\"\n\nexport default class DirectUploadController {\n  uploadedFile: UploadedFile\n  file: File\n  directUpload: any\n  recordXHR: XMLHttpRequest\n  uploadXHR: XMLHttpRequest\n  callback = null\n\n  constructor(uploadedFile) {\n    this.uploadedFile = uploadedFile\n    this.file = this.uploadedFile[\"file\"]\n    this.directUpload = new DirectUpload(this.file, this.uploadedFile.url, this)\n  }\n\n  cancel() {\n    this.directUpload.url = null\n    this.abortXHR(this.recordXHR)\n    this.abortXHR(this.uploadXHR)\n  }\n\n  abortXHR(xhr) {\n    if(!xhr) return\n    xhr.addEventListener(\"abort\", () => {\n      this.complete(\"aborted\", {})\n    })\n    xhr.abort()\n  }\n\n  start(callback) {\n    this.callback = callback\n    this.dispatch(\"start\")\n    this.directUpload.create((error, attributes) => {\n      this.complete(error, attributes)\n    })\n  }\n\n  complete(error, _attributes) {\n    if (error) {\n      this.dispatchError(error)\n    }\n    this.dispatch(\"end\")\n    this.callback(error)\n  }\n\n  uploadRequestDidProgress(event) {\n    const progress = event.loaded / event.total * 100;\n    if (progress) {\n      this.dispatch(\"progress\", {\n        progress: progress\n      });\n    }\n  }\n  dispatch(name, detail = {}) {\n    return dispatchEvent(this.uploadedFile, `direct-upload:${name}`, {\n      detail: {\n        ...detail,\n        file: this.file,\n        id: this.directUpload.id,\n      }\n    });\n  }\n  dispatchError(error) {\n    this.dispatch(\"error\", {\n      error: error\n    })\n  }\n  directUploadWillCreateBlobWithXHR(xhr) {\n    this.recordXHR = xhr\n    this.dispatch(\"before-blob-request\", {\n      xhr: xhr\n    });\n  }\n  directUploadWillStoreFileWithXHR(xhr) {\n    this.uploadXHR = xhr\n    this.uploadedFile.value = this.recordXHR.response.signed_id\n    this.dispatch(\"before-storage-request\", {\n      xhr: xhr\n    });\n    xhr.upload.addEventListener(\"progress\", (event => this.uploadRequestDidProgress(event)));\n  }\n}\n\nfunction dispatchEvent(element: any, type, eventInit = {} as any) {\n  const {disabled: disabled} = element;\n  const {bubbles: bubbles, cancelable: cancelable, detail: detail} = eventInit;\n  const event = document.createEvent(\"Event\") as any;\n  event.initEvent(type, bubbles || true, cancelable || true);\n  event.detail = detail || {};\n  try {\n    element.disabled = false;\n    element.dispatchEvent(event);\n  } finally {\n    element.disabled = disabled;\n  }\n  return event;\n}\n\n","import { UploadedFile } from './uploaded-file'\n\nexport default class Max {\n  uploadedFile: UploadedFile\n\n  constructor(uploadedFile) {\n    this.uploadedFile = uploadedFile\n  }\n\n  get errors() {\n    if(this.#errors) return this.#errors\n    this.#errors = []\n    if(!this.checkValidity()) {\n      this.#errors.push(this.errorMessage)\n    }\n    return this.#errors\n  }\n\n  #errors: Array<string>\n\n  checkValidity() {\n    if(!this.uploadedFile.max) return true\n    return this.uploadedFile.size <= this.uploadedFile.max\n  }\n\n  get errorMessage() {\n    return [\n      `Must be smaller than ${this.formatBytes(this.uploadedFile.max)},`,\n      `and \"${this.uploadedFile.filename}\" is ${this.formatBytes(this.uploadedFile.size)}.`,\n      `Please attach a smaller file.`,\n    ].join(\" \")\n  }\n\n  formatBytes(bytes, decimals = 2) {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const dm = decimals < 0 ? 0 : decimals;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + sizes[i];\n  }\n}\n\n","import { UploadedFile } from './uploaded-file'\n\nexport default class Accepts {\n  uploadedFile: UploadedFile\n\n  constructor(uploadedFile) {\n    this.uploadedFile = uploadedFile\n  }\n\n  get errors() {\n    if(this.#errors) return this.#errors\n    this.#errors = []\n\n    const accepts = this.uploadedFile.accepts ? this.uploadedFile.accepts.split(/,\\s*/) : []\n\n    if(accepts.length > 0 && !accepts.includes(this.uploadedFile.filetype)) {\n      this.#errors.push(`Must be a ${this.joinWords(accepts)}.`)\n    }\n    return this.#errors\n  }\n\n  #errors: Array<string>\n\n  private joinWords(words) {\n    if(words.length >= 3) {\n      return (words.slice(0, -1) + [`or ${words.at(-1)}`]).join(\", \")\n    } else {\n      return words.join(\" or \")\n    }\n  }\n}\n\n","export default {\n  image: [\"ase\", \"art\", \"bmp\", \"blp\", \"cd5\", \"cit\", \"cpt\", \"cr2\", \"cut\", \"dds\", \"dib\", \"djvu\", \"egt\", \"exif\", \"gif\", \"gpl\", \"grf\", \"icns\", \"ico\", \"iff\", \"jng\", \"jpeg\", \"jpg\", \"jfif\", \"jp2\", \"jps\", \"lbm\", \"max\", \"miff\", \"mng\", \"msp\", \"nef\", \"nitf\", \"ota\", \"pbm\", \"pc1\", \"pc2\", \"pc3\", \"pcf\", \"pcx\", \"pdn\", \"pgm\", \"PI1\", \"PI2\", \"PI3\", \"pict\", \"pct\", \"pnm\", \"pns\", \"ppm\", \"psb\", \"psd\", \"pdd\", \"psp\", \"px\", \"pxm\", \"pxr\", \"qfx\", \"raw\", \"rle\", \"sct\", \"sgi\", \"rgb\", \"int\", \"bw\", \"tga\", \"tiff\", \"tif\", \"vtf\", \"xbm\", \"xcf\", \"xpm\", \"3dv\", \"amf\", \"ai\", \"awg\", \"cgm\", \"cdr\", \"cmx\", \"dxf\", \"e2d\", \"egt\", \"eps\", \"fs\", \"gbr\", \"odg\", \"svg\", \"stl\", \"vrml\", \"x3d\", \"sxd\", \"v2d\", \"vnd\", \"wmf\", \"emf\", \"art\", \"xar\", \"png\", \"webp\", \"jxr\", \"hdp\", \"wdp\", \"cur\", \"ecw\", \"iff\", \"lbm\", \"liff\", \"nrrd\", \"pam\", \"pcx\", \"pgf\", \"sgi\", \"rgb\", \"rgba\", \"bw\", \"int\", \"inta\", \"sid\", \"ras\", \"sun\", \"tga\", \"heic\", \"heif\"],\n  video: [\"3g2\", \"3gp\", \"3gpp\", \"aaf\", \"asf\", \"avchd\", \"avi\", \"drc\", \"flv\", \"m2v\", \"m3u8\", \"m4p\", \"m4v\", \"mkv\", \"mng\", \"mov\", \"mp2\", \"mp4\", \"mpe\", \"mpeg\", \"mpg\", \"mpv\", \"mxf\", \"nsv\", \"ogg\", \"ogv\", \"qt\", \"rm\", \"rmvb\", \"roq\", \"svi\", \"vob\", \"webm\", \"wmv\", \"yuv\"],\n  pdf: [\"pdf\"],\n\n  getFileType: function(filename) {\n    const normalized = filename.toString().split(\".\").at(-1).toLowerCase().trim()\n    if(this.video.includes(normalized)) return \"video\" \n    if(this.image.includes(normalized)) return \"image\" \n    if(this.pdf.includes(normalized)) return \"pdf\" \n    return \"unknown\"\n  }\n}\n","export class FetchResponse {\n  constructor (response) {\n    this.response = response\n  }\n\n  get statusCode () {\n    return this.response.status\n  }\n\n  get redirected () {\n    return this.response.redirected\n  }\n\n  get ok () {\n    return this.response.ok\n  }\n\n  get unauthenticated () {\n    return this.statusCode === 401\n  }\n\n  get unprocessableEntity () {\n    return this.statusCode === 422\n  }\n\n  get authenticationURL () {\n    return this.response.headers.get('WWW-Authenticate')\n  }\n\n  get contentType () {\n    const contentType = this.response.headers.get('Content-Type') || ''\n\n    return contentType.replace(/;.*$/, '')\n  }\n\n  get headers () {\n    return this.response.headers\n  }\n\n  get html () {\n    if (this.contentType.match(/^(application|text)\\/(html|xhtml\\+xml)$/)) {\n      return this.text\n    }\n\n    return Promise.reject(new Error(`Expected an HTML response but got \"${this.contentType}\" instead`))\n  }\n\n  get json () {\n    if (this.contentType.match(/^application\\/.*json$/)) {\n      return this.responseJson || (this.responseJson = this.response.json())\n    }\n\n    return Promise.reject(new Error(`Expected a JSON response but got \"${this.contentType}\" instead`))\n  }\n\n  get text () {\n    return this.responseText || (this.responseText = this.response.text())\n  }\n\n  get isTurboStream () {\n    return this.contentType.match(/^text\\/vnd\\.turbo-stream\\.html/)\n  }\n\n  async renderTurboStream () {\n    if (this.isTurboStream) {\n      if (window.Turbo) {\n        await window.Turbo.renderStreamMessage(await this.text)\n      } else {\n        console.warn('You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js')\n      }\n    } else {\n      return Promise.reject(new Error(`Expected a Turbo Stream response but got \"${this.contentType}\" instead`))\n    }\n  }\n}\n","export class RequestInterceptor {\n  static register (interceptor) {\n    this.interceptor = interceptor\n  }\n\n  static get () {\n    return this.interceptor\n  }\n\n  static reset () {\n    this.interceptor = undefined\n  }\n}\n","export function getCookie (name) {\n  const cookies = document.cookie ? document.cookie.split('; ') : []\n  const prefix = `${encodeURIComponent(name)}=`\n  const cookie = cookies.find(cookie => cookie.startsWith(prefix))\n\n  if (cookie) {\n    const value = cookie.split('=').slice(1).join('=')\n\n    if (value) {\n      return decodeURIComponent(value)\n    }\n  }\n}\n\nexport function compact (object) {\n  const result = {}\n\n  for (const key in object) {\n    const value = object[key]\n    if (value !== undefined) {\n      result[key] = value\n    }\n  }\n\n  return result\n}\n\nexport function metaContent (name) {\n  const element = document.head.querySelector(`meta[name=\"${name}\"]`)\n  return element && element.content\n}\n\nexport function stringEntriesFromFormData (formData) {\n  return [...formData].reduce((entries, [name, value]) => {\n    return entries.concat(typeof value === 'string' ? [[name, value]] : [])\n  }, [])\n}\n\nexport function mergeEntries (searchParams, entries) {\n  for (const [name, value] of entries) {\n    if (value instanceof window.File) continue\n\n    if (searchParams.has(name)) {\n      searchParams.delete(name)\n      searchParams.set(name, value)\n    } else {\n      searchParams.append(name, value)\n    }\n  }\n}\n","import { FetchResponse } from './fetch_response'\nimport { RequestInterceptor } from './request_interceptor'\nimport { getCookie, compact, metaContent, stringEntriesFromFormData, mergeEntries } from './lib/utils'\n\nexport class FetchRequest {\n  constructor (method, url, options = {}) {\n    this.method = method\n    this.options = options\n    this.originalUrl = url.toString()\n  }\n\n  async perform () {\n    try {\n      const requestInterceptor = RequestInterceptor.get()\n      if (requestInterceptor) {\n        await requestInterceptor(this)\n      }\n    } catch (error) {\n      console.error(error)\n    }\n\n    const response = new FetchResponse(await window.fetch(this.url, this.fetchOptions))\n\n    if (response.unauthenticated && response.authenticationURL) {\n      return Promise.reject(window.location.href = response.authenticationURL)\n    }\n\n    if (response.ok && response.isTurboStream) {\n      await response.renderTurboStream()\n    }\n\n    return response\n  }\n\n  addHeader (key, value) {\n    const headers = this.additionalHeaders\n    headers[key] = value\n    this.options.headers = headers\n  }\n\n  get fetchOptions () {\n    return {\n      method: this.method.toUpperCase(),\n      headers: this.headers,\n      body: this.formattedBody,\n      signal: this.signal,\n      credentials: 'same-origin',\n      redirect: this.redirect\n    }\n  }\n\n  get headers () {\n    return compact(\n      Object.assign({\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-CSRF-Token': this.csrfToken,\n        'Content-Type': this.contentType,\n        Accept: this.accept\n      },\n      this.additionalHeaders)\n    )\n  }\n\n  get csrfToken () {\n    return getCookie(metaContent('csrf-param')) || metaContent('csrf-token')\n  }\n\n  get contentType () {\n    if (this.options.contentType) {\n      return this.options.contentType\n    } else if (this.body == null || this.body instanceof window.FormData) {\n      return undefined\n    } else if (this.body instanceof window.File) {\n      return this.body.type\n    }\n\n    return 'application/json'\n  }\n\n  get accept () {\n    switch (this.responseKind) {\n      case 'html':\n        return 'text/html, application/xhtml+xml'\n      case 'turbo-stream':\n        return 'text/vnd.turbo-stream.html, text/html, application/xhtml+xml'\n      case 'json':\n        return 'application/json, application/vnd.api+json'\n      default:\n        return '*/*'\n    }\n  }\n\n  get body () {\n    return this.options.body\n  }\n\n  get query () {\n    const originalQuery = (this.originalUrl.split('?')[1] || '').split('#')[0]\n    const params = new URLSearchParams(originalQuery)\n\n    let requestQuery = this.options.query\n    if (requestQuery instanceof window.FormData) {\n      requestQuery = stringEntriesFromFormData(requestQuery)\n    } else if (requestQuery instanceof window.URLSearchParams) {\n      requestQuery = requestQuery.entries()\n    } else {\n      requestQuery = Object.entries(requestQuery || {})\n    }\n\n    mergeEntries(params, requestQuery)\n\n    const query = params.toString()\n    return (query.length > 0 ? `?${query}` : '')\n  }\n\n  get url () {\n    return (this.originalUrl.split('?')[0]).split('#')[0] + this.query\n  }\n\n  get responseKind () {\n    return this.options.responseKind || 'html'\n  }\n\n  get signal () {\n    return this.options.signal\n  }\n\n  get redirect () {\n    return this.options.redirect || 'follow'\n  }\n\n  get additionalHeaders () {\n    return this.options.headers || {}\n  }\n\n  get formattedBody () {\n    const bodyIsAString = Object.prototype.toString.call(this.body) === '[object String]'\n    const contentTypeIsJson = this.headers['Content-Type'] === 'application/json'\n\n    if (contentTypeIsJson && !bodyIsAString) {\n      return JSON.stringify(this.body)\n    }\n\n    return this.body\n  }\n}\n","import { FetchRequest } from '@rails/request.js'\n\nconst request = (verb, url, payload) => {\n  const req = new FetchRequest(verb, url, {\n    headers: { Accept: \"application/json\" },\n    body: payload,\n  })\n  return req.perform().then(response => {\n    if(response.response.ok) {\n      return response.json\n    } else {\n      return response\n    }\n  })\n}\n\nconst get = (url, payload) => request('get', url, payload)\nconst post = (url, payload) => request('post', url, payload)\nconst put = (url, payload) => request('put', url, payload)\nconst patch = (url, payload) => request('patch', url, payload)\nconst destroy = (url, payload) => request('delete', url, payload)\n\nexport { request, get, post, put, patch, destroy }\n","var DOCUMENT_FRAGMENT_NODE = 11;\n\nfunction morphAttrs(fromNode, toNode) {\n    var toNodeAttrs = toNode.attributes;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    // document-fragments dont have attributes so lets not do anything\n    if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE || fromNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n      return;\n    }\n\n    // update attributes on original DOM element\n    for (var i = toNodeAttrs.length - 1; i >= 0; i--) {\n        attr = toNodeAttrs[i];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n        attrValue = attr.value;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n            fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n            if (fromValue !== attrValue) {\n                if (attr.prefix === 'xmlns'){\n                    attrName = attr.name; // It's not allowed to set an attribute with the XMLNS namespace without specifying the `xmlns` prefix\n                }\n                fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n            }\n        } else {\n            fromValue = fromNode.getAttribute(attrName);\n\n            if (fromValue !== attrValue) {\n                fromNode.setAttribute(attrName, attrValue);\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    var fromNodeAttrs = fromNode.attributes;\n\n    for (var d = fromNodeAttrs.length - 1; d >= 0; d--) {\n        attr = fromNodeAttrs[d];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n\n            if (!toNode.hasAttributeNS(attrNamespaceURI, attrName)) {\n                fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n            }\n        } else {\n            if (!toNode.hasAttribute(attrName)) {\n                fromNode.removeAttribute(attrName);\n            }\n        }\n    }\n}\n\nvar range; // Create a range object for efficently rendering strings to elements.\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar doc = typeof document === 'undefined' ? undefined : document;\nvar HAS_TEMPLATE_SUPPORT = !!doc && 'content' in doc.createElement('template');\nvar HAS_RANGE_SUPPORT = !!doc && doc.createRange && 'createContextualFragment' in doc.createRange();\n\nfunction createFragmentFromTemplate(str) {\n    var template = doc.createElement('template');\n    template.innerHTML = str;\n    return template.content.childNodes[0];\n}\n\nfunction createFragmentFromRange(str) {\n    if (!range) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment = range.createContextualFragment(str);\n    return fragment.childNodes[0];\n}\n\nfunction createFragmentFromWrap(str) {\n    var fragment = doc.createElement('body');\n    fragment.innerHTML = str;\n    return fragment.childNodes[0];\n}\n\n/**\n * This is about the same\n * var html = new DOMParser().parseFromString(str, 'text/html');\n * return html.body.firstChild;\n *\n * @method toElement\n * @param {String} str\n */\nfunction toElement(str) {\n    str = str.trim();\n    if (HAS_TEMPLATE_SUPPORT) {\n      // avoid restrictions on content for things like `<tr><th>Hi</th></tr>` which\n      // createContextualFragment doesn't support\n      // <template> support not available in IE\n      return createFragmentFromTemplate(str);\n    } else if (HAS_RANGE_SUPPORT) {\n      return createFragmentFromRange(str);\n    }\n\n    return createFragmentFromWrap(str);\n}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n    var fromCodeStart, toCodeStart;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    fromCodeStart = fromNodeName.charCodeAt(0);\n    toCodeStart = toNodeName.charCodeAt(0);\n\n    // If the target element is a virtual DOM node or SVG node then we may\n    // need to normalize the tag name before comparing. Normal HTML elements that are\n    // in the \"http://www.w3.org/1999/xhtml\"\n    // are converted to upper case\n    if (fromCodeStart <= 90 && toCodeStart >= 97) { // from is upper and to is lower\n        return fromNodeName === toNodeName.toUpperCase();\n    } else if (toCodeStart <= 90 && fromCodeStart >= 97) { // to is upper and from is lower\n        return toNodeName === fromNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name);\n        }\n    }\n}\n\nvar specialElHandlers = {\n    OPTION: function(fromEl, toEl) {\n        var parentNode = fromEl.parentNode;\n        if (parentNode) {\n            var parentName = parentNode.nodeName.toUpperCase();\n            if (parentName === 'OPTGROUP') {\n                parentNode = parentNode.parentNode;\n                parentName = parentNode && parentNode.nodeName.toUpperCase();\n            }\n            if (parentName === 'SELECT' && !parentNode.hasAttribute('multiple')) {\n                if (fromEl.hasAttribute('selected') && !toEl.selected) {\n                    // Workaround for MS Edge bug where the 'selected' attribute can only be\n                    // removed if set to a non-empty value:\n                    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n                    fromEl.setAttribute('selected', 'selected');\n                    fromEl.removeAttribute('selected');\n                }\n                // We have to reset select element's selectedIndex to -1, otherwise setting\n                // fromEl.selected using the syncBooleanAttrProp below has no effect.\n                // The correct selectedIndex will be set in the SELECT special handler below.\n                parentNode.selectedIndex = -1;\n            }\n        }\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!toEl.hasAttribute('value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        var firstChild = fromEl.firstChild;\n        if (firstChild) {\n            // Needed for IE. Apparently IE sets the placeholder as the\n            // node value and vise versa. This ignores an empty update.\n            var oldValue = firstChild.nodeValue;\n\n            if (oldValue == newValue || (!newValue && oldValue == fromEl.placeholder)) {\n                return;\n            }\n\n            firstChild.nodeValue = newValue;\n        }\n    },\n    SELECT: function(fromEl, toEl) {\n        if (!toEl.hasAttribute('multiple')) {\n            var selectedIndex = -1;\n            var i = 0;\n            // We have to loop through children of fromEl, not toEl since nodes can be moved\n            // from toEl to fromEl directly when morphing.\n            // At the time this special handler is invoked, all children have already been morphed\n            // and appended to / removed from fromEl, so using fromEl here is safe and correct.\n            var curChild = fromEl.firstChild;\n            var optgroup;\n            var nodeName;\n            while(curChild) {\n                nodeName = curChild.nodeName && curChild.nodeName.toUpperCase();\n                if (nodeName === 'OPTGROUP') {\n                    optgroup = curChild;\n                    curChild = optgroup.firstChild;\n                } else {\n                    if (nodeName === 'OPTION') {\n                        if (curChild.hasAttribute('selected')) {\n                            selectedIndex = i;\n                            break;\n                        }\n                        i++;\n                    }\n                    curChild = curChild.nextSibling;\n                    if (!curChild && optgroup) {\n                        curChild = optgroup.nextSibling;\n                        optgroup = null;\n                    }\n                }\n            }\n\n            fromEl.selectedIndex = selectedIndex;\n        }\n    }\n};\n\nvar ELEMENT_NODE = 1;\nvar DOCUMENT_FRAGMENT_NODE$1 = 11;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\nfunction noop() {}\n\nfunction defaultGetNodeKey(node) {\n  if (node) {\n    return (node.getAttribute && node.getAttribute('id')) || node.id;\n  }\n}\n\nfunction morphdomFactory(morphAttrs) {\n\n  return function morphdom(fromNode, toNode, options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (typeof toNode === 'string') {\n      if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML' || fromNode.nodeName === 'BODY') {\n        var toNodeHtml = toNode;\n        toNode = doc.createElement('html');\n        toNode.innerHTML = toNodeHtml;\n      } else {\n        toNode = toElement(toNode);\n      }\n    } else if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n      toNode = toNode.firstElementChild;\n    }\n\n    var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n    var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n    var onNodeAdded = options.onNodeAdded || noop;\n    var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n    var onElUpdated = options.onElUpdated || noop;\n    var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n    var onNodeDiscarded = options.onNodeDiscarded || noop;\n    var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n    var skipFromChildren = options.skipFromChildren || noop;\n    var addChild = options.addChild || function(parent, child){ return parent.appendChild(child); };\n    var childrenOnly = options.childrenOnly === true;\n\n    // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n    var fromNodesLookup = Object.create(null);\n    var keyedRemovalList = [];\n\n    function addKeyedRemoval(key) {\n      keyedRemovalList.push(key);\n    }\n\n    function walkDiscardedChildNodes(node, skipKeyedNodes) {\n      if (node.nodeType === ELEMENT_NODE) {\n        var curChild = node.firstChild;\n        while (curChild) {\n\n          var key = undefined;\n\n          if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n            // If we are skipping keyed nodes then we add the key\n            // to a list so that it can be handled at the very end.\n            addKeyedRemoval(key);\n          } else {\n            // Only report the node as discarded if it is not keyed. We do this because\n            // at the end we loop through all keyed elements that were unmatched\n            // and then discard them in one final pass.\n            onNodeDiscarded(curChild);\n            if (curChild.firstChild) {\n              walkDiscardedChildNodes(curChild, skipKeyedNodes);\n            }\n          }\n\n          curChild = curChild.nextSibling;\n        }\n      }\n    }\n\n    /**\n    * Removes a DOM node out of the original DOM\n    *\n    * @param  {Node} node The node to remove\n    * @param  {Node} parentNode The nodes parent\n    * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n    * @return {undefined}\n    */\n    function removeNode(node, parentNode, skipKeyedNodes) {\n      if (onBeforeNodeDiscarded(node) === false) {\n        return;\n      }\n\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n\n      onNodeDiscarded(node);\n      walkDiscardedChildNodes(node, skipKeyedNodes);\n    }\n\n    // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n    // function indexTree(root) {\n    //     var treeWalker = document.createTreeWalker(\n    //         root,\n    //         NodeFilter.SHOW_ELEMENT);\n    //\n    //     var el;\n    //     while((el = treeWalker.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n    //\n    // function indexTree(node) {\n    //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n    //     var el;\n    //     while((el = nodeIterator.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    function indexTree(node) {\n      if (node.nodeType === ELEMENT_NODE || node.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n        var curChild = node.firstChild;\n        while (curChild) {\n          var key = getNodeKey(curChild);\n          if (key) {\n            fromNodesLookup[key] = curChild;\n          }\n\n          // Walk recursively\n          indexTree(curChild);\n\n          curChild = curChild.nextSibling;\n        }\n      }\n    }\n\n    indexTree(fromNode);\n\n    function handleNodeAdded(el) {\n      onNodeAdded(el);\n\n      var curChild = el.firstChild;\n      while (curChild) {\n        var nextSibling = curChild.nextSibling;\n\n        var key = getNodeKey(curChild);\n        if (key) {\n          var unmatchedFromEl = fromNodesLookup[key];\n          // if we find a duplicate #id node in cache, replace `el` with cache value\n          // and morph it to the child node.\n          if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n            curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n            morphEl(unmatchedFromEl, curChild);\n          } else {\n            handleNodeAdded(curChild);\n          }\n        } else {\n          // recursively call for curChild and it's children to see if we find something in\n          // fromNodesLookup\n          handleNodeAdded(curChild);\n        }\n\n        curChild = nextSibling;\n      }\n    }\n\n    function cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey) {\n      // We have processed all of the \"to nodes\". If curFromNodeChild is\n      // non-null then we still have some from nodes left over that need\n      // to be removed\n      while (curFromNodeChild) {\n        var fromNextSibling = curFromNodeChild.nextSibling;\n        if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n          // Since the node is keyed it might be matched up later so we defer\n          // the actual removal to later\n          addKeyedRemoval(curFromNodeKey);\n        } else {\n          // NOTE: we skip nested keyed nodes from being removed since there is\n          //       still a chance they will be matched up later\n          removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n        }\n        curFromNodeChild = fromNextSibling;\n      }\n    }\n\n    function morphEl(fromEl, toEl, childrenOnly) {\n      var toElKey = getNodeKey(toEl);\n\n      if (toElKey) {\n        // If an element with an ID is being morphed then it will be in the final\n        // DOM so clear it out of the saved elements collection\n        delete fromNodesLookup[toElKey];\n      }\n\n      if (!childrenOnly) {\n        // optional\n        if (onBeforeElUpdated(fromEl, toEl) === false) {\n          return;\n        }\n\n        // update attributes on original DOM element first\n        morphAttrs(fromEl, toEl);\n        // optional\n        onElUpdated(fromEl);\n\n        if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n          return;\n        }\n      }\n\n      if (fromEl.nodeName !== 'TEXTAREA') {\n        morphChildren(fromEl, toEl);\n      } else {\n        specialElHandlers.TEXTAREA(fromEl, toEl);\n      }\n    }\n\n    function morphChildren(fromEl, toEl) {\n      var skipFrom = skipFromChildren(fromEl, toEl);\n      var curToNodeChild = toEl.firstChild;\n      var curFromNodeChild = fromEl.firstChild;\n      var curToNodeKey;\n      var curFromNodeKey;\n\n      var fromNextSibling;\n      var toNextSibling;\n      var matchingFromEl;\n\n      // walk the children\n      outer: while (curToNodeChild) {\n        toNextSibling = curToNodeChild.nextSibling;\n        curToNodeKey = getNodeKey(curToNodeChild);\n\n        // walk the fromNode children all the way through\n        while (!skipFrom && curFromNodeChild) {\n          fromNextSibling = curFromNodeChild.nextSibling;\n\n          if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n            curToNodeChild = toNextSibling;\n            curFromNodeChild = fromNextSibling;\n            continue outer;\n          }\n\n          curFromNodeKey = getNodeKey(curFromNodeChild);\n\n          var curFromNodeType = curFromNodeChild.nodeType;\n\n          // this means if the curFromNodeChild doesnt have a match with the curToNodeChild\n          var isCompatible = undefined;\n\n          if (curFromNodeType === curToNodeChild.nodeType) {\n            if (curFromNodeType === ELEMENT_NODE) {\n              // Both nodes being compared are Element nodes\n\n              if (curToNodeKey) {\n                // The target node has a key so we want to match it up with the correct element\n                // in the original DOM tree\n                if (curToNodeKey !== curFromNodeKey) {\n                  // The current element in the original DOM tree does not have a matching key so\n                  // let's check our lookup to see if there is a matching element in the original\n                  // DOM tree\n                  if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                    if (fromNextSibling === matchingFromEl) {\n                      // Special case for single element removals. To avoid removing the original\n                      // DOM node out of the tree (since that can break CSS transitions, etc.),\n                      // we will instead discard the current node and wait until the next\n                      // iteration to properly match up the keyed target element with its matching\n                      // element in the original tree\n                      isCompatible = false;\n                    } else {\n                      // We found a matching keyed element somewhere in the original DOM tree.\n                      // Let's move the original DOM node into the current position and morph\n                      // it.\n\n                      // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                      // the `removeNode()` function for the node that is being discarded so that\n                      // all lifecycle hooks are correctly invoked\n                      fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                      // fromNextSibling = curFromNodeChild.nextSibling;\n\n                      if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                      } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                      }\n\n                      curFromNodeChild = matchingFromEl;\n                    }\n                  } else {\n                    // The nodes are not compatible since the \"to\" node has a key and there\n                    // is no matching keyed node in the source tree\n                    isCompatible = false;\n                  }\n                }\n              } else if (curFromNodeKey) {\n                // The original has a key\n                isCompatible = false;\n              }\n\n              isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n              if (isCompatible) {\n                // We found compatible DOM elements so transform\n                // the current \"from\" node to match the current\n                // target DOM node.\n                // MORPH\n                morphEl(curFromNodeChild, curToNodeChild);\n              }\n\n            } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n              // Both nodes being compared are Text or Comment nodes\n              isCompatible = true;\n              // Simply update nodeValue on the original node to\n              // change the text value\n              if (curFromNodeChild.nodeValue !== curToNodeChild.nodeValue) {\n                curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n              }\n\n            }\n          }\n\n          if (isCompatible) {\n            // Advance both the \"to\" child and the \"from\" child since we found a match\n            // Nothing else to do as we already recursively called morphChildren above\n            curToNodeChild = toNextSibling;\n            curFromNodeChild = fromNextSibling;\n            continue outer;\n          }\n\n          // No compatible match so remove the old node from the DOM and continue trying to find a\n          // match in the original DOM. However, we only do this if the from node is not keyed\n          // since it is possible that a keyed node might match up with a node somewhere else in the\n          // target tree and we don't want to discard it just yet since it still might find a\n          // home in the final DOM tree. After everything is done we will remove any keyed nodes\n          // that didn't find a home\n          if (curFromNodeKey) {\n            // Since the node is keyed it might be matched up later so we defer\n            // the actual removal to later\n            addKeyedRemoval(curFromNodeKey);\n          } else {\n            // NOTE: we skip nested keyed nodes from being removed since there is\n            //       still a chance they will be matched up later\n            removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n          }\n\n          curFromNodeChild = fromNextSibling;\n        } // END: while(curFromNodeChild) {}\n\n        // If we got this far then we did not find a candidate match for\n        // our \"to node\" and we exhausted all of the children \"from\"\n        // nodes. Therefore, we will just append the current \"to\" node\n        // to the end\n        if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n          // MORPH\n          if(!skipFrom){ addChild(fromEl, matchingFromEl); }\n          morphEl(matchingFromEl, curToNodeChild);\n        } else {\n          var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n          if (onBeforeNodeAddedResult !== false) {\n            if (onBeforeNodeAddedResult) {\n              curToNodeChild = onBeforeNodeAddedResult;\n            }\n\n            if (curToNodeChild.actualize) {\n              curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n            }\n            addChild(fromEl, curToNodeChild);\n            handleNodeAdded(curToNodeChild);\n          }\n        }\n\n        curToNodeChild = toNextSibling;\n        curFromNodeChild = fromNextSibling;\n      }\n\n      cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey);\n\n      var specialElHandler = specialElHandlers[fromEl.nodeName];\n      if (specialElHandler) {\n        specialElHandler(fromEl, toEl);\n      }\n    } // END: morphChildren(...)\n\n    var morphedNode = fromNode;\n    var morphedNodeType = morphedNode.nodeType;\n    var toNodeType = toNode.nodeType;\n\n    if (!childrenOnly) {\n      // Handle the case where we are given two DOM nodes that are not\n      // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n      if (morphedNodeType === ELEMENT_NODE) {\n        if (toNodeType === ELEMENT_NODE) {\n          if (!compareNodeNames(fromNode, toNode)) {\n            onNodeDiscarded(fromNode);\n            morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n          }\n        } else {\n          // Going from an element node to a text node\n          morphedNode = toNode;\n        }\n      } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n        if (toNodeType === morphedNodeType) {\n          if (morphedNode.nodeValue !== toNode.nodeValue) {\n            morphedNode.nodeValue = toNode.nodeValue;\n          }\n\n          return morphedNode;\n        } else {\n          // Text node to something else\n          morphedNode = toNode;\n        }\n      }\n    }\n\n    if (morphedNode === toNode) {\n      // The \"to node\" was not compatible with the \"from node\" so we had to\n      // toss out the \"from node\" and use the \"to node\"\n      onNodeDiscarded(fromNode);\n    } else {\n      if (toNode.isSameNode && toNode.isSameNode(morphedNode)) {\n        return;\n      }\n\n      morphEl(morphedNode, toNode, childrenOnly);\n\n      // We now need to loop over any keyed nodes that might need to be\n      // removed. We only do the removal if we know that the keyed node\n      // never found a match. When a keyed node is matched up we remove\n      // it out of fromNodesLookup and we use fromNodesLookup to determine\n      // if a keyed node has been matched up or not\n      if (keyedRemovalList) {\n        for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n          var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n          if (elToRemove) {\n            removeNode(elToRemove, elToRemove.parentNode, false);\n          }\n        }\n      }\n    }\n\n    if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n      if (morphedNode.actualize) {\n        morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n      }\n      // If we had to swap out the from node with a new node because the old\n      // node was not compatible with the target node then we need to\n      // replace the old DOM node in the original DOM tree. This is only\n      // possible if the original DOM node was part of a DOM tree which\n      // we know is the case if it has a parent node.\n      fromNode.parentNode.replaceChild(morphedNode, fromNode);\n    }\n\n    return morphedNode;\n  };\n}\n\nvar morphdom = morphdomFactory(morphAttrs);\n\nexport default morphdom;\n","import morph from \"morphdom\"\n\nfunction html(html) {\n  const el = document.createElement(\"div\")\n  morph(el, `<div>${html}</div>`)\n  return el.children[0]\n}\n\nfunction arrayRemove(arr, e) {\n  const index = arr.findIndex(x => x === e)\n  if(index !== -1) {\n    arr.splice(index, 1)\n  }\n}\n\nexport { morph, html, arrayRemove }\n",":host {\n  display: block;\n  width: 100%;\n  max-width: 100%;\n  font-size: 13px;\n}\n\nfigure{\n  margin: 0;\n}\n\n.progress-details{\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\nprogress-bar{\n  flex: 1 0;\n  padding: 0 10px;\n}\n\nprogress-bar.pending{\n  opacity: 0.5;\n}\n\nprogress-bar.complete {\n  opacity: 0.8;\n}\n\nprogress-bar:not(.complete) + .progress-icon{\n  display: none;\n}\n\nprogress-bar.complete + .progress-icon{\n  content: url('data:image/svg+xml;utf8,<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 20 20\" style=\"enable-background:new 0 0 20 20;\" xml:space=\"preserve\"><g><path d=\"M6.3,9.1c0.2,0,0.5,0.1,0.7,0.4c0.5,0.5,1,1,1.4,1.4c0.3,0.3,0.3,0.3,0.6,0c1.4-1.3,2.7-2.6,4-3.9c0.3-0.3,0.6-0.4,1-0.4 c0.5,0.1,0.9,0.6,0.7,1.1c-0.1,0.2-0.2,0.4-0.3,0.6c-1.6,1.6-3.2,3.2-4.8,4.8c-0.5,0.5-1,0.5-1.6,0c-0.8-0.7-1.5-1.5-2.3-2.3 c-0.3-0.3-0.5-0.6-0.3-1.1C5.5,9.3,5.8,9.1,6.3,9.1z\"/></g></svg>');\n  filter: invert(100%);\n}\n\n.progress-icon{\n  display: inline-block;\n  flex: 0 0 20px;\n  width: 28px;\n  height: 28px;\n  background-size: contain;\n  position: absolute;\n  right: 30px;\n  z-index: 1;\n}\n\nprogress-bar.error{\n  background: #f8b3b1;\n  background: rgba(74, 70, 70, 0.25);\n  opacity: 1;\n}\n\n.progress-bar a{color: #fff;}\n\n.download-link{\n  padding-right: 20px;\n  color: #fff;\n}\n\n.remove-media{\n  display: inline-block;\n  content: url('data:image/svg+xml;utf8,<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 40 40\" style=\"enable-background:new 0 0 40 40;\" xml:space=\"preserve\"><g><path d=\"M0,19.9C0.2,8.5,9.2-0.1,20.1,0C31.8,0.1,40.2,9.5,40,20.4c-0.2,11-8.9,19.7-20.1,19.6C8,39.9,0,30.5,0,19.9z M20,3.7 c-9,0-16.3,7-16.3,16.2C3.7,29,10.9,36.3,20,36.3c9,0,16.3-7.1,16.4-16.3C36.3,11,29.2,3.8,20,3.7z\"/><path d=\"M17.3,20c-0.2-0.2-0.3-0.4-0.5-0.6c-1-1-2-1.9-2.9-2.9c-0.5-0.5-0.8-1.1-0.7-1.9c0.1-0.7,0.5-1.2,1.2-1.4 c0.8-0.2,1.5,0,2.1,0.6c1,1,2,2,3,3.1c0.3,0.4,0.6,0.3,0.9,0c1-1,2-2,3-3c0.3-0.3,0.7-0.5,1.1-0.6c0.8-0.2,1.6,0.1,2,0.8 c0.4,0.8,0.3,1.7-0.4,2.4c-1,1-2,2-3,3c-0.2,0.2-0.3,0.4-0.5,0.6c1.2,1.2,2.3,2.3,3.4,3.4c0.6,0.6,0.9,1.3,0.6,2.2 c-0.4,1.1-1.7,1.6-2.6,1c-0.3-0.2-0.5-0.4-0.8-0.6c-1-1-1.9-1.9-2.9-2.9c-0.3-0.3-0.5-0.3-0.9,0c-1,1-2,2.1-3,3 c-0.4,0.4-1,0.6-1.5,0.8c-0.6,0.1-1.2-0.2-1.5-0.8c-0.4-0.6-0.5-1.3-0.1-1.9c0.2-0.3,0.4-0.5,0.6-0.7C15.1,22.3,16.2,21.2,17.3,20z \"/></g></svg>');\n  flex: 0 0 25px;\n  width: 25px;\n  height: 20px;\n  align-items: center;\n  opacity: 0.25;\n}\n\n.remove-media:hover{\n  opacity: 1;\n  filter: invert(50%)sepia(100%)saturate(10000%);\n}\n\n.remove-media span{\n  display: inline-block;\n  text-indent: -9999px;\n  color: transparent;\n}\n","import { Component, Prop, Element, Watch, Host, h } from '@stencil/core'\nimport { Listen, Event, EventEmitter } from '@stencil/core'\nimport DirectUploadController from './direct-upload-controller'\nimport Max from './max'\nimport Accepts from './accepts'\nimport Extensions from './extensions'\nimport { get } from 'rails-request-json'\nimport { morph, html } from \"../../utils/utils\"\n\nlet uid = 0\n\n@Component({\n  tag: 'uploaded-file',\n  styleUrl: 'uploaded-file.css',\n  shadow: true,\n})\nexport class UploadedFile {\n  @Element() el\n\n  @Prop({ reflect: true, mutable: true }) name: string\n  @Prop({ reflect: true, mutable: true }) accepts: string\n  @Prop({ reflect: true, mutable: true }) max: number\n  @Prop({ reflect: true, mutable: true }) url: string\n\n  @Prop({ reflect: true, mutable: true }) value: string = \"\"\n  @Prop({ reflect: true, mutable: true }) filename: string\n  @Prop({ reflect: true, mutable: true }) src: string\n  @Prop({ reflect: true, mutable: true }) filetype: string\n  @Prop({ reflect: true, mutable: true }) size: number\n  @Prop({ reflect: true, mutable: true }) state: string = \"complete\"\n  @Prop({ reflect: true, mutable: true }) percent: number = 100\n  @Prop({ reflect: true, mutable: true }) preview: boolean = true\n\n  @Prop() validationMessage: string\n\n  @Event({ eventName: \"uploaded-file:remove\" }) removeEvent: EventEmitter\n\n  private removeClicked = event => {\n    event.stopPropagation()\n    event.preventDefault()\n    this.controller?.cancel()\n    this.removeEvent.emit(this)\n  }\n\n  inputTarget: HTMLInputElement\n  controller: DirectUploadController\n  _file: File\n  uid: number\n\n  constructor() {\n    this.uid = uid++\n    this.inputTarget = html(`<input id=\"input-target-${this.uid}\">`) as HTMLInputElement\n  }\n\n  componentWillLoad() {\n    this.el.appendChild(this.inputTarget)\n    this.setMissingFiletype()\n  }\n\n  get file() {\n    return this._file\n  }\n\n  set file(file: any) {\n    this.src = URL.createObjectURL(file)\n    this.filename = file.name\n    this.size = file.size\n    this.state = \"pending\"\n    this.percent = 0\n    this._file = file\n  }\n\n  set signedId(val) {\n    if(this.value !== val) {\n      get(`/rails/active_storage/blobs/info/${val}`).then(blob => {\n        this.src = `/rails/active_storage/blobs/redirect/${val}/${blob.filename}`\n        this.filename = blob.filename\n        this.size = blob.byte_size\n        this.state = \"complete\"\n        this.percent = 100\n        this.value = val\n      })\n    }\n  }\n\n  @Watch(\"filename\")\n  setMissingFiletype(_value?, _previousValue?) {\n    if(!this.filetype && this.filename) {\n      this.filetype = Extensions.getFileType(this.filename)\n    }\n  }\n\n  @Listen(\"direct-upload:initialize\")\n  @Listen(\"direct-upload:start\")\n  start(_event) {\n    this.state = \"pending\"\n    this.percent = 0\n  }\n\n  @Listen(\"direct-upload:progress\")\n  progress(event) {\n    const { progress } = event.detail\n    this.percent = progress\n  }\n\n  @Listen(\"direct-upload:error\")\n  error(event) {\n    event.preventDefault()\n    const { error } = event.detail\n    this.state = \"error\"\n    this.inputTarget.setCustomValidity(error)\n  }\n\n  @Listen(\"direct-upload:end\")\n  end(_event) {\n    if(this.state !== \"error\") {\n      this.state = \"complete\"\n      this.percent = 100\n    }\n  }\n\n  render() {\n    return (\n      <Host>\n        <slot>\n        </slot>\n        <figure>\n          <div class=\"progress-details\">\n            <progress-bar percent={this.percent} class={this.state}>\n              <a class=\"download-link\" href={this.src} download={this.filename} onClick={e => e.stopPropagation()}>\n                {this.filename}\n              </a>\n            </progress-bar>\n            <span class=\"progress-icon\"></span>\n            <a class=\"remove-media\" onClick={this.removeClicked} href=\"#\">\n              <span>Remove media</span>\n            </a>\n          </div>\n          {this.preview ? <file-preview src={this.src} filetype={this.filetype}></file-preview> : ''}\n        </figure>\n      </Host>\n    )\n  }\n\n  componentDidRender() {\n    morph(this.inputTarget, `\n      <input\n        id=\"input-target-${this.uid}\"\n        style=\"opacity: 0.01; width: 1px; height: 1px; z-index: -999; position: absolute;\"\n        name=\"${this.name}\"\n        value=\"${this.value}\"\n      >`)\n  }\n\n  componentDidLoad() {\n    if(this.checkValidity() && this.state == \"pending\") {\n      this.controller = new DirectUploadController(this.el)\n      this.controller.dispatch(\"initialize\", { controller: this.controller })\n    }\n  }\n\n  checkValidity() {\n    let errors = []\n    errors.push(...new Accepts(this).errors)\n    errors.push(...new Max(this).errors)\n    this.inputTarget.setCustomValidity(errors.join(\" \"))\n    this.inputTarget.reportValidity()\n    return errors.length === 0\n  }\n}\n","/**\n * File Drop Component\n *\n * A vanilla JS custom element for drag-and-drop file handling.\n * Provides drag-and-drop interface that assigns files to a target input element.\n *\n * Usage:\n *   <file-drop for=\"file-input\">Drop files here</file-drop>\n *   <input type=\"file\" id=\"file-input\" multiple>\n *\n * Features:\n * - Drag and drop file handling\n * - Click to open file picker\n * - Visual feedback during drag operations\n * - Framework-agnostic vanilla JS\n */\n\nclass FileDrop extends HTMLElement {\n  constructor() {\n    super()\n    this.handleDragOver = this.handleDragOver.bind(this)\n    this.handleDragLeave = this.handleDragLeave.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n  }\n\n  static get observedAttributes() {\n    return ['for']\n  }\n\n  connectedCallback() {\n    this.addEventListener('dragover', this.handleDragOver)\n    this.addEventListener('dragleave', this.handleDragLeave)\n    this.addEventListener('drop', this.handleDrop)\n    this.applyDefaultStyles()\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener('dragover', this.handleDragOver)\n    this.removeEventListener('dragleave', this.handleDragLeave)\n    this.removeEventListener('drop', this.handleDrop)\n  }\n\n  get fileTarget() {\n    const forValue = this.getAttribute('for')\n    if (!forValue) return null\n    return document.querySelector(`#${forValue}`)\n  }\n\n\n  handleDragOver(event) {\n    event.preventDefault()\n    this.classList.add('-dragover')\n  }\n\n  handleDragLeave() {\n    this.classList.remove('-dragover')\n  }\n\n  handleDrop(event) {\n    event.preventDefault()\n    this.classList.remove('-dragover')\n\n    const target = this.fileTarget\n    if (target && event.dataTransfer.files.length > 0) {\n      target.files = event.dataTransfer.files\n      const changeEvent = new Event('change', { bubbles: true })\n      target.dispatchEvent(changeEvent)\n    }\n  }\n\n  applyDefaultStyles() {\n    if (!this.hasAttribute('data-no-default-styles')) {\n      const styles = `\n        file-drop {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          box-sizing: border-box;\n          min-height: 60px;\n          outline-offset: -10px;\n          padding: 20px;\n          background: rgba(255, 255, 255, 0.25);\n          text-align: center;\n          transition: all 0.15s ease 0s;\n          outline: rgba(0, 0, 0, 0.25) dashed 2px;\n          font-size: 13px;\n        }\n\n        file-drop.-dragover {\n          background: rgba(0, 0, 0, 0.1);\n          outline-color: rgba(0, 0, 0, 0.5);\n        }\n      `\n\n      if (!document.querySelector('#file-drop-default-styles')) {\n        const styleElement = document.createElement('style')\n        styleElement.id = 'file-drop-default-styles'\n        styleElement.textContent = styles\n        document.head.appendChild(styleElement)\n      }\n    }\n  }\n}\n\n// Auto-register the custom element\nif (!customElements.get('file-drop')) {\n  customElements.define('file-drop', FileDrop)\n}\n\nexport { FileDrop }",":host {\n  display: block;\n  padding: 25px;\n  color: var(--bard-file-text-color, #000);\n  font-size: 13px;\n}\n\nfile-drop {\n  cursor: pointer;\n}\n:host *{\n  box-sizing: border-box;\n  position: relative;\n}\ndrag-and-drop{\n  display: block;\n  outline-offset: -10px;\n  background: rgba(255,255,255, 0.25);\n  margin: 0;\n  text-align: center;\n  transition: all 0.15s;\n  outline: 2px dashed rgba(0,0,0,0.25);\n  color: #444;\n  font-size: 14px;\n}\n\np{\n  padding: 10px 20px;\n  margin: 0;\n}\n\ndrag-and-drop.-full{\n  width: 100%;\n}\n.-dragover{\n  background: rgba(255,255,255,0.5);\n  outline: 2px dashed rgba(0,0,0,0.25);\n}\n\n.media-preview {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: flex-start;\n  justify-content: center;\n}\n\n// UPLOADER\n\n.direct-upload-wrapper{\n  position: fixed;\n  z-index: 9999;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(#333, 0.9);\n}\n\n.direct-upload-content{\n  display: block;\n  background: #fcfcfc;\n  padding: 40px 60px 60px;\n  border-radius: 3px;\n  width: 60vw;\n}\n.direct-upload-content h3{\n  border-bottom: 2px solid #1f1f1f;\n  margin-bottom: 20px;\n}\n\n.separate-upload{\n  padding: 0 10px;\n  margin-top: 10px;\n  font-size: 0.9em;\n}\n\n.direct-upload--pending{\n  opacity: 0.6;\n}\n\n.direct-upload--complete {\n  opacity: 0.4;\n}\n\n.direct-upload--error{\n  border-color: red;\n}\n\ninput[type=file][data-direct-upload-url][disabled]{\n  display: none;\n}\n\n:host.separate-upload{\n  padding: 0 10px;\n  margin-top: 10px;\n  font-size: 0.9em;\n}\n","import { Component, Element, Prop, State, Listen, Host, h } from '@stencil/core';\nimport FormController from \"./form-controller\"\nimport { UploadedFile } from \"../uploaded-file/uploaded-file\"\nimport { morph, html, arrayRemove } from \"../../utils/utils\"\nimport '@botandrose/file-drop'\n\n@Component({\n  tag: 'bard-file',\n  styleUrl: 'bard-file.css',\n  shadow: true,\n})\nexport class BardFile {\n  @Element() el: HTMLElement\n\n  @Prop() name: string\n  @Prop() directupload: string\n  @Prop() multiple: boolean = false\n\n  @Prop() required: boolean = false\n  @Prop() accepts: string\n  @Prop() max: number\n  @Prop() preview: boolean = true\n\n  @State() _forceUpdate: boolean = false\n  forceUpdate() { this._forceUpdate = !this._forceUpdate }\n\n  form: HTMLFormElement\n  fileTargetId: string\n  fileTarget: HTMLInputElement\n  hiddenTargetId: string\n  hiddenTarget: HTMLInputElement\n  _files: Array<any> = []\n\n  constructor() {\n    this.fileTargetId = this.el.id\n    this.fileTarget = html(`<input id=\"${this.fileTargetId}\">`) as HTMLInputElement\n    this.hiddenTargetId = `hidden-target-${this.el.getAttribute(\"name\")}`\n    this.hiddenTarget = html(`<input id=\"${this.hiddenTargetId}\">`) as HTMLInputElement\n  }\n\n  componentWillLoad() {\n    this.el.removeAttribute(\"id\")\n    this.form = this.el.closest(\"form\")\n    this.form.addEventListener(\"reset\", () => this.reset())\n    FormController.instance(this.form)\n    const existingFiles = Array.from(this.el.children).filter(e => e.tagName == \"UPLOADED-FILE\");\n    if(existingFiles.length > 0) this.files = existingFiles\n  }\n\n  // Methods\n\n  get files() {\n    return this._files\n  }\n\n  set files(val) {\n    this._files = val\n    if(!this.multiple) this._files = this._files.slice(-1)\n    this.forceUpdate()\n    this.fireChangeEvent()\n  }\n\n  get value() {\n    return this.files.map(e => e.value)\n  }\n\n  set value(val) {\n    const newValue = val || []\n    if(JSON.stringify(this.value) !== JSON.stringify(newValue)) { // this is insane. javascript is fucking garbage.\n      this.files = newValue.map(signedId => Object.assign(new UploadedFile(), {\n        name: this.name,\n        preview: this.preview,\n        signedId,\n      }))\n    }\n  }\n\n  reset() {\n    this.value = []\n  }\n\n  @Listen(\"change\")\n  fileTargetChanged(event) {\n    if(event.target !== this.fileTarget) return\n    this.files.push(...Array.from(this.fileTarget.files).map(file => Object.assign(new UploadedFile(), {\n      name: this.name,\n      preview: this.preview,\n      url: this.directupload,\n      accepts: this.accepts,\n      max: this.max,\n      file,\n    })))\n    this.files = this.files\n    this.fileTarget.value = null\n  }\n\n  @Listen(\"uploaded-file:remove\")\n  removeUploadedFile(event) {\n    arrayRemove(this.files, event.detail)\n    this.files = this.files\n  }\n\n  @Listen(\"direct-upload:end\")\n  fireChangeEvent() {\n    requestAnimationFrame(() => this.el.dispatchEvent(new Event(\"change\", { bubbles: true })))\n  }\n\n  // Rendering\n\n  render() {\n    return (\n      <Host>\n        <file-drop for={this.fileTargetId} onClick={() => this.fileTarget.click()}>\n          <p part=\"title\">\n            <strong>Choose {this.multiple ? \"files\" : \"file\"} </strong>\n            <span>or drag {this.multiple ? \"them\" : \"it\"} here.</span>\n          </p>\n\n          <div class={`media-preview ${this.multiple ? '-stacked' : ''}`}>\n            <slot></slot>\n          </div>\n        </file-drop>\n      </Host>\n    )\n  }\n\n  componentDidRender() {\n    morph(this.fileTarget, `\n      <input id=\"${this.fileTargetId}\"\n        type=\"file\"\n        ${this.multiple ? \"multiple\" : \"\"}\n        ${this.required && this.files.length === 0 ? \"required\" : \"\"}\n        style=\"opacity: 0.01; width: 1px; height: 1px; z-index: -999\"\n      >`)\n    morph(this.hiddenTarget, `\n      <input id=\"${this.hiddenTargetId}\"\n        type=\"hidden\"\n        name=\"${this.name}\"\n        ${this.files.length > 0 ? \"disabled\" : \"\"}\n      >`)\n\n    const wrapper = document.createElement(\"div\")\n    // Clear wrapper and append children (replaceChildren polyfill)\n    while (wrapper.firstChild) {\n      wrapper.removeChild(wrapper.firstChild)\n    }\n    wrapper.appendChild(this.fileTarget)\n    wrapper.appendChild(this.hiddenTarget)\n    this.files.forEach(file => wrapper.appendChild(file))\n    morph(this.el, wrapper, { childrenOnly: true })\n  }\n\n  // Validations\n\n  checkValidity() {\n    return this.fileTarget.checkValidity()\n  }\n\n  setCustomValidity(msg) {\n    this.fileTarget.setCustomValidity(msg)\n  }\n\n  reportValidity() {\n    this.fileTarget.reportValidity()\n  }\n\n  get validationMessage() {\n    return this.fileTarget.validationMessage\n  }\n}\n",":host {\n  display: block;\n  font-size: 13px;\n}\nimg, video {\n  max-width: 100%;\n  margin-top: 10px;\n}\n","import { Component, Prop, Host, h } from '@stencil/core';\n\n@Component({\n  tag: 'file-preview',\n  styleUrl: 'file-preview.css',\n  shadow: true,\n})\nexport class FilePreview {\n  @Prop({ reflect: true }) src: string\n  @Prop({ reflect: true }) filetype: string\n\n  render() {\n    return (\n      <Host class={this.computeClass()}>\n        {this.isImage() && <img src={this.src} />}\n        {this.isVideo() && <video src={this.src} onClick={toggle} />}\n        {this.isOther() && \"This file does not offer a preview\"}\n        <slot></slot>\n      </Host>\n    );\n  }\n\n  private computeClass() {\n    if(this.isImage()) return \"image\"\n    if(this.isVideo()) return \"video\"\n    return \"other\"\n  }\n\n  private isImage() {\n    return this.filetype == \"image\"\n  }\n\n  private isVideo() {\n    return this.filetype == \"video\"\n  }\n\n  private isOther() {\n    return !this.isImage() && !this.isVideo()\n  }\n}\n\nconst toggle = function() { this.paused ? this.play() : this.pause(); return false }\n",":host {\n  display: block;\n  position: relative;\n  padding: 0 20px;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  border-radius: 3px;\n  line-height: 2;\n  flex: 1 0;\n  box-sizing: border-box;\n  text-align: left;\n  font-size: 13px;\n}\n\n.bar {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  background: rgba(57, 137, 39, 1);\n  transition: width 120ms ease-out, opacity 60ms 60ms ease-in;\n  transform: translate3d(0, 0, 0);\n}\n\n.content {\n  position: relative;\n  color: #fff;\n  font-size: 1em;\n}\n","import { Component, Prop, Host, h } from '@stencil/core';\n\n@Component({\n  tag: 'progress-bar',\n  styleUrl: 'progress-bar.css',\n  shadow: true,\n})\nexport class ProgressBar {\n  @Prop({ reflect: true }) percent: number = 0\n\n  render() {\n    return (\n      <Host>\n        <div class=\"bar\" style={{ width: `${this.percent}%` }}></div>\n        <span class=\"content\">\n          <slot></slot>\n        </span>\n      </Host>\n    )\n  }\n}\n"],"mappings":"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"}