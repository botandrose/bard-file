{"file":"input-attachment.js","mappings":"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","names":["InputAttachment","__stencil_proxyCustomElement","HTMLElement"],"sources":["src/components/input-attachment/form-controller.tsx","src/utils/utils.ts","../file-drop/src/file-drop.js","src/components/input-attachment/input-attachment.css?tag=input-attachment&encapsulation=shadow","src/components/input-attachment/input-attachment.tsx"],"sourcesContent":["import DirectUploadController from \"../attachment-file/direct-upload-controller\"\n\nexport default class FormController {\n  static instance(form) {\n    return form.inputAttachmentFormController ||= new FormController(form)\n  }\n\n  progressContainerTarget: HTMLElement\n  dialog: HTMLDialogElement\n\n  element: HTMLFormElement\n  progressTargetMap: {}\n  controllers: Array<DirectUploadController>\n  submitted: boolean\n  processing: boolean\n  errors: boolean\n\n  constructor(form) {\n    this.element = form\n    this.progressTargetMap = {}\n    this.controllers = []\n    this.submitted = false\n    this.processing = false\n    this.errors = false\n\n    this.element.insertAdjacentHTML(\"beforeend\",\n      `<dialog id=\"form-controller-dialog\">\n        <div class=\"direct-upload-wrapper\">\n          <div class=\"direct-upload-content\">\n            <h3>Uploading your media</h3>\n            <div id=\"progress-container\"></div>\n          </div>\n        </div>\n      </dialog>`)\n\n    this.dialog = this.element.querySelector(\"#form-controller-dialog\")\n    this.progressContainerTarget = this.dialog.querySelector(\"#progress-container\")\n\n    if(this.element.dataset.remote !== \"true\" && (this.element.dataset.turbo == \"false\" || !(window as any).Turbo?.session?.enabled)) {\n      this.element.addEventListener(\"submit\", event => this.submit(event))\n    }\n    window.addEventListener(\"beforeunload\", event => this.beforeUnload(event))\n\n    this.element.addEventListener(\"direct-upload:initialize\", event => this.init(event))\n    this.element.addEventListener(\"direct-upload:start\", event => this.start(event))\n    this.element.addEventListener(\"direct-upload:progress\", event => this.progress(event))\n    this.element.addEventListener(\"direct-upload:error\", event => this.error(event))\n    this.element.addEventListener(\"direct-upload:end\", event => this.end(event))\n\n    this.element.addEventListener(\"attachment-file:remove\", event => this.removeUploadedFile(event))\n  }\n\n  beforeUnload(event) {\n    if(this.processing) {\n      event.preventDefault()\n      return (event.returnValue = \"\")\n    }\n  }\n\n  submit(event) {\n    event.preventDefault()\n    this.submitted = true\n    this.startNextController()\n    if(this.processing) {\n      this.dialog.showModal()\n    }\n  }\n\n  startNextController() {\n    if(this.processing) return\n\n    const controller = this.controllers.shift()\n    if(controller) {\n      this.processing = true\n      this.setInputAttachmentsDisabled(true)\n      controller.start(error => {\n        if(error) {\n          this.setInputAttachmentsDisabled(false)\n        }\n        this.processing = false\n        this.startNextController()\n      })\n    } else {\n      this.submitForm()\n    }\n  }\n\n  submitForm() {\n    if(this.submitted) {\n      this.setInputAttachmentsDisabled(true)\n      window.setTimeout(() => { // allow other async tasks to complete\n        this.element.submit()\n      }, 10)\n    }\n  }\n\n  setInputAttachmentsDisabled(disabled: boolean) {\n    Array.from(this.element.querySelectorAll(\"input-attachment\"))\n      .forEach((el: any) => {\n        el.disabled = disabled\n      })\n  }\n\n  init(event) {\n    const { id, file, controller } = event.detail\n\n    this.progressContainerTarget.insertAdjacentHTML(\"beforebegin\", `\n      <progress-bar id=\"direct-upload-${id}\" class=\"direct-upload--pending\">${file.name}</progress-bar>\n    `)\n    const progressTarget = document.getElementById(`direct-upload-${id}`)\n    this.progressTargetMap[id] = progressTarget\n\n    this.controllers.push(controller)\n    this.startNextController()\n  }\n\n  start(event) {\n    this.progressTargetMap[event.detail.id].classList.remove(\"direct-upload--pending\")\n  }\n\n  progress(event) {\n    const { id, progress } = event.detail\n    this.progressTargetMap[id].percent = progress\n  }\n\n  error(event) {\n    event.preventDefault()\n    const { id, error } = event.detail\n    const target = this.progressTargetMap[id]\n    target.classList.add(\"direct-upload--error\")\n    target.title = error\n  }\n\n  end(event) {\n    this.progressTargetMap[event.detail.id].classList.add(\"direct-upload--complete\")\n  }\n\n  removeUploadedFile(event) {\n    const uploadedFile = event.detail\n    const id = uploadedFile.controller?.directUpload?.id\n    if(id) {\n      document.getElementById(`direct-upload-${id}`).remove()\n      delete this.progressTargetMap[id]\n    }\n  }\n}\n\n\n","function html(html) {\n  const el = document.createElement(\"div\")\n  el.innerHTML = html\n  return el.children[0]\n}\n\nfunction arrayRemove(arr, e) {\n  const index = arr.findIndex(x => x === e)\n  if(index !== -1) {\n    arr.splice(index, 1)\n  }\n}\n\nexport { html, arrayRemove }\n","/**\n * File Drop Component\n *\n * A vanilla JS custom element for drag-and-drop file handling.\n * Provides drag-and-drop interface that assigns files to a target input element.\n *\n * Usage:\n *   <file-drop for=\"file-input\">Drop files here</file-drop>\n *   <input type=\"file\" id=\"file-input\" multiple>\n *\n * Features:\n * - Drag and drop file handling\n * - Click to open file picker\n * - Visual feedback during drag operations\n * - Framework-agnostic vanilla JS\n */\n\nclass FileDrop extends HTMLElement {\n  constructor() {\n    super()\n    this.handleDragOver = this.handleDragOver.bind(this)\n    this.handleDragLeave = this.handleDragLeave.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n  }\n\n  static get observedAttributes() {\n    return ['for']\n  }\n\n  connectedCallback() {\n    this.addEventListener('dragover', this.handleDragOver)\n    this.addEventListener('dragleave', this.handleDragLeave)\n    this.addEventListener('drop', this.handleDrop)\n    this.applyDefaultStyles()\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener('dragover', this.handleDragOver)\n    this.removeEventListener('dragleave', this.handleDragLeave)\n    this.removeEventListener('drop', this.handleDrop)\n  }\n\n  get fileTarget() {\n    const forValue = this.getAttribute('for')\n    if (!forValue) return null\n    return document.querySelector(`#${forValue}`)\n  }\n\n\n  handleDragOver(event) {\n    event.preventDefault()\n    this.classList.add('-dragover')\n  }\n\n  handleDragLeave() {\n    this.classList.remove('-dragover')\n  }\n\n  handleDrop(event) {\n    event.preventDefault()\n    this.classList.remove('-dragover')\n\n    const target = this.fileTarget\n    if (target && event.dataTransfer.files.length > 0) {\n      target.files = event.dataTransfer.files\n      const changeEvent = new Event('change', { bubbles: true })\n      target.dispatchEvent(changeEvent)\n    }\n  }\n\n  applyDefaultStyles() {\n    if (!this.hasAttribute('data-no-default-styles')) {\n      const styles = `\n        file-drop {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          box-sizing: border-box;\n          min-height: 60px;\n          outline-offset: -10px;\n          padding: 20px;\n          background: rgba(255, 255, 255, 0.25);\n          text-align: center;\n          transition: all 0.15s ease 0s;\n          outline: rgba(0, 0, 0, 0.25) dashed 2px;\n          font-size: 13px;\n        }\n\n        file-drop.-dragover {\n          background: rgba(0, 0, 0, 0.1);\n          outline-color: rgba(0, 0, 0, 0.5);\n        }\n      `\n\n      if (!document.querySelector('#file-drop-default-styles')) {\n        const styleElement = document.createElement('style')\n        styleElement.id = 'file-drop-default-styles'\n        styleElement.textContent = styles\n        document.head.appendChild(styleElement)\n      }\n    }\n  }\n}\n\n// Auto-register the custom element\nif (!customElements.get('file-drop')) {\n  customElements.define('file-drop', FileDrop)\n}\n\nexport { FileDrop }",":host {\n  display: block;\n  padding: 25px;\n  color: var(--input-attachment-text-color, #000);\n  font-size: 13px;\n}\n\nfile-drop {\n  cursor: pointer;\n}\n:host *{\n  box-sizing: border-box;\n  position: relative;\n}\ndrag-and-drop{\n  display: block;\n  outline-offset: -10px;\n  background: rgba(255,255,255, 0.25);\n  margin: 0;\n  text-align: center;\n  transition: all 0.15s;\n  outline: 2px dashed rgba(0,0,0,0.25);\n  color: #444;\n  font-size: 14px;\n}\n\np{\n  padding: 10px 20px;\n  margin: 0;\n}\n\ndrag-and-drop.-full{\n  width: 100%;\n}\n.-dragover{\n  background: rgba(255,255,255,0.5);\n  outline: 2px dashed rgba(0,0,0,0.25);\n}\n\n.media-preview {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: flex-start;\n  justify-content: center;\n}\n\n// UPLOADER\n\n.direct-upload-wrapper{\n  position: fixed;\n  z-index: 9999;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(#333, 0.9);\n}\n\n.direct-upload-content{\n  display: block;\n  background: #fcfcfc;\n  padding: 40px 60px 60px;\n  border-radius: 3px;\n  width: 60vw;\n}\n.direct-upload-content h3{\n  border-bottom: 2px solid #1f1f1f;\n  margin-bottom: 20px;\n}\n\n.separate-upload{\n  padding: 0 10px;\n  margin-top: 10px;\n  font-size: 0.9em;\n}\n\n.direct-upload--pending{\n  opacity: 0.6;\n}\n\n.direct-upload--complete {\n  opacity: 0.4;\n}\n\n.direct-upload--error{\n  border-color: red;\n}\n\ninput[type=file][data-direct-upload-url][disabled]{\n  display: none;\n}\n\n:host.separate-upload{\n  padding: 0 10px;\n  margin-top: 10px;\n  font-size: 0.9em;\n}\n","import { Component, Element, Prop, State, Listen, Host, h } from '@stencil/core';\nimport FormController from \"./form-controller\"\nimport { AttachmentFile } from \"../attachment-file/attachment-file\"\nimport { arrayRemove } from \"../../utils/utils\"\nimport '@botandrose/file-drop'\n\n@Component({\n  tag: 'input-attachment',\n  styleUrl: 'input-attachment.css',\n  shadow: true,\n})\nexport class InputAttachment {\n  @Element() el: HTMLElement\n\n  @Prop() name: string\n  @Prop() directupload: string\n  @Prop() multiple: boolean = false\n\n  @Prop() required: boolean = false\n  @Prop() accepts: string\n  @Prop() max: number\n  @Prop() preview: boolean = true\n  @Prop() disabled: boolean = false\n\n  @State() _forceUpdate: boolean = false\n  forceUpdate() { this._forceUpdate = !this._forceUpdate }\n\n  form: HTMLFormElement\n  internals: ElementInternals\n  fileInput: HTMLInputElement\n  _files: Array<any> = []\n\n  constructor() {\n    this.internals = (this.el as any).attachInternals()\n  }\n\n  componentWillLoad() {\n    this.form = this.internals.form\n    if (this.form) {\n      this.form.addEventListener(\"reset\", () => this.reset())\n      FormController.instance(this.form)\n    }\n    const existingFiles = Array.from(this.el.children).filter(e => e.tagName == \"ATTACHMENT-FILE\");\n    if(existingFiles.length > 0) this.files = existingFiles\n  }\n\n  // Methods\n\n  get files() {\n    return this._files\n  }\n\n  set files(val) {\n    this._files = val\n    if(!this.multiple) this._files = this._files.slice(-1)\n    this.forceUpdate()\n    this.fireChangeEvent()\n  }\n\n  get value() {\n    return this.files.map(e => e.value)\n  }\n\n  set value(val) {\n    const newValue = val || []\n    if(JSON.stringify(this.value) !== JSON.stringify(newValue)) { // this is insane. javascript is fucking garbage.\n      this.files = newValue.map(signedId => Object.assign(new AttachmentFile(), {\n        name: this.name,\n        preview: this.preview,\n        signedId,\n      }))\n    }\n  }\n\n  updateFormValue() {\n    if (!this.name || !this.internals?.setFormValue) return\n    const formData = new FormData()\n    formData.set(this.name, JSON.stringify(this.value))\n    this.internals.setFormValue(formData)\n  }\n\n  reset() {\n    this.value = []\n  }\n\n  @Listen(\"change\")\n  fileTargetChanged(event) {\n    if(event.target !== this.fileInput) return\n    this.files.push(...Array.from(this.fileInput.files).map(file => Object.assign(new AttachmentFile(), {\n      name: this.name,\n      preview: this.preview,\n      url: this.directupload,\n      accepts: this.accepts,\n      max: this.max,\n      file,\n    })))\n    this.files = this.files\n    this.fileInput.value = null\n  }\n\n  @Listen(\"attachment-file:remove\")\n  removeUploadedFile(event) {\n    arrayRemove(this.files, event.detail)\n    this.files = this.files\n  }\n\n  @Listen(\"direct-upload:end\")\n  fireChangeEvent() {\n    requestAnimationFrame(() => {\n      this.updateFormValue()\n      this.el.dispatchEvent(new Event(\"change\", { bubbles: true }))\n    })\n  }\n\n  // Rendering\n\n  render() {\n    return (\n      <Host>\n        <input\n          ref={el => this.fileInput = el}\n          type=\"file\"\n          multiple={this.multiple}\n          accept={this.accepts}\n          required={this.required && this.files.length === 0}\n          disabled={this.disabled}\n          style={{\n            opacity: '0.01',\n            width: '1px',\n            height: '1px',\n            zIndex: '-999'\n          }}\n        />\n        <file-drop onClick={() => this.fileInput?.click()}>\n          <p part=\"title\">\n            <strong>Choose {this.multiple ? \"files\" : \"file\"} </strong>\n            <span>or drag {this.multiple ? \"them\" : \"it\"} here.</span>\n          </p>\n\n          <div class={`media-preview ${this.multiple ? '-stacked' : ''}`}>\n            <slot></slot>\n          </div>\n        </file-drop>\n      </Host>\n    )\n  }\n\n  componentDidRender() {\n    const wrapper = document.createElement(\"div\")\n    while (wrapper.firstChild) {\n      wrapper.removeChild(wrapper.firstChild)\n    }\n    this.files.forEach(file => wrapper.appendChild(file))\n\n    let needsUpdate = false\n    if (wrapper.children.length !== this.el.children.length) {\n      needsUpdate = true\n    } else {\n      for (let i = 0; i < wrapper.children.length; i++) {\n        if (wrapper.children[i] !== this.el.children[i]) {\n          needsUpdate = true\n          break\n        }\n      }\n    }\n\n    if (needsUpdate) {\n      while (this.el.firstChild) {\n        this.el.removeChild(this.el.firstChild)\n      }\n      this.el.appendChild(wrapper)\n    }\n\n    this.updateFormValue()\n  }\n\n  // Validations\n\n  checkValidity() {\n    if (this.required && this.files.length === 0) {\n      return false\n    }\n    return true\n  }\n\n  setCustomValidity(msg: string) {\n    this.internals.setValidity(msg ? { customError: true } : {}, msg, this.fileInput)\n  }\n\n  reportValidity() {\n    return this.internals.reportValidity()\n  }\n\n  get validationMessage() {\n    return this.internals.validationMessage\n  }\n}\n"],"version":3}